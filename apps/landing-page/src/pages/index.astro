---
// src/pages/index.astro
import '../styles/global.css';
import { AsciiGhost } from '../components/AsciiGhost';
import { ArchitectureDiagram } from '../components/ArchitectureDiagram';
import { LiveCodeEditor } from '../components/LiveCodeEditor';
import { MerkleTree, MerkleDashboard } from '../components/MerkleTreeAnimation';
import SchemaGenerator from '../components/SchemaGenerator';
import GitHubStars from '../components/GitHubStars';
import { DevToolsSimulation } from '../components/DevToolsSimulation';
import SectionHeadline from '../components/SectionHeadline.astro';

const schemaCode = `DEFINE TABLE user SCHEMAFULL;
DEFINE FIELD username ON user TYPE string;

DEFINE TABLE thread SCHEMAFULL;
DEFINE FIELD title ON thread TYPE string;
DEFINE FIELD author ON thread TYPE record<user>;`;

const generatedCode = `export type User = {
  id: string;
  username: string;
};

export type Thread = {
  id: string;
  title: string;
  author: User | string;
};`;

const solidQueryCode = `import { useQuery } from "@spooky/client-solid";
import { db } from "../db";

const ThreadList = () => {
  const result = useQuery(db, () =>
    db.query("thread")
      .related("comments")
      .orderBy("created_at", "desc")
      .limit(10)
      .build()
  );

  return (
    <For each={result.data()}>
      {(thread) => (
        <div>{thread.title} by {thread.author.username}</div>
      )}
    </For>
  );
};`;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/spooky/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content="Spooky Sync - A SurrealDB native Sync Engine" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={Astro.site} />
    <meta property="og:title" content="Spooky Sync: The SurrealDB Native Real-Time Sync Engine" />
    <meta
      property="og:description"
      content="Build local-first, offline-ready applications with Spooky Sync. Use the power of SurrealDB to synchronize data instantly across devices."
    />
    <meta property="og:image" content={new URL('/spooky/social_card.png', Astro.site)} />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={Astro.site} />
    <meta
      property="twitter:title"
      content="Spooky Sync: The SurrealDB Native Real-Time Sync Engine"
    />
    <meta
      property="twitter:description"
      content="Build local-first, offline-ready applications with Spooky Sync. Use the power of SurrealDB to synchronize data instantly across devices."
    />
    <meta property="twitter:image" content={new URL('/spooky/social_card.png', Astro.site)} />
    <title>SPOOKY SYNC</title>
  </head>
  <body class="min-h-screen flex flex-col">
    <div class="border-b border-white border-dashed p-4 uppercase bg-black">
      <nav class="max-w-7xl mx-auto flex justify-between items-center">
        <span class="font-bold tracking-widest">[ SPOOKY_SYNC ]</span>
        <div class="hidden md:block font-mono text-sm">
          <GitHubStars client:visible />
        </div>
      </nav>
    </div>
    <section
      id="home"
      class="min-h-screen flex items-center justify-center relative border-b border-white/10 py-24"
    >
      <div class="max-w-5xl mx-auto px-4 text-center">
        <AsciiGhost client:load />

        <h1 class="text-2xl md:text-4xl font-bold mb-6 uppercase tracking-widest">
          [ SPOOKY_SYNC ]
        </h1>

        <div
          class="text-left font-mono text-xs md:text-sm max-w-xl mx-auto mb-12 border-2 border-white bg-black shadow-[5px_5px_0px_0px_#eeeeee] relative z-10"
        >
          <div
            class="border-b-2 border-white bg-paper text-black px-3 py-1 font-bold flex justify-between items-center uppercase"
          >
            <span>src/queries.ts</span>
            <span>[ TS ]</span>
          </div>
          <div class="p-6 overflow-x-auto bg-black text-gray-300">
            <pre><code><span class="text-white font-bold">const</span> thread = <span class="text-white font-bold">await</span> db
  .query(<span class="text-green-400">"thread"</span>)
  .where(&#123;
    id: params.id 
  &#125;)
  .related(<span class="text-green-400">"author"</span>)
  .related(<span class="text-green-400">"comments"</span>, (q) => q
    .related(<span class="text-green-400">"author"</span>)
    .orderBy(<span class="text-green-400">"created_at"</span>, <span class="text-green-400">"desc"</span>)
    .limit(10)
  )
  .one();<span class="animate-blink inline-block w-2 h-4 bg-white ml-1 align-middle" /></code></pre>
          </div>
        </div>
        <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
          <a
            href={`${process.env.ASTRO_BASE_PATH}/docs`}
            class="border-2 border-white bg-white text-black px-12 py-3 hover:bg-black hover:text-white transition-none uppercase font-bold"
          >
            [ VIEW_DOCS ]
          </a>
          <a
            href="https://github.com/mono424/spooky"
            target="_blank"
            class="border-2 border-white/10 px-8 py-3 hover:bg-white hover:text-black transition-none uppercase font-bold"
          >
            [ VIEW_SOURCE ]
          </a>
        </div>
      </div>
    </section>

    <section id="features" class="pt-12 pb-24">
      <div class="max-w-7xl mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Card 1: Offline Compatibility -->
          <div
            class="group relative bg-[#050505] border border-[#222] p-8 hover:bg-[#0a0a0a] transition-colors duration-500 overflow-hidden"
          >
            <div
              class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"
            >
            </div>

            <div class="relative z-10 flex flex-col h-full">
              <div class="flex items-start justify-between mb-6">
                <div
                  class="text-[10px] font-mono text-gray-600 uppercase tracking-widest border border-[#333] px-2 py-1 rounded"
                >
                  01_LOCAL
                </div>
                <svg
                  class="w-5 h-5 text-gray-600 group-hover:text-white transition-colors"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"
                  ></path>
                </svg>
              </div>

              <h3
                class="text-lg font-bold uppercase tracking-wider text-gray-200 mb-3 group-hover:text-white transition-colors"
              >
                Offline Compatibility
              </h3>

              <p
                class="font-mono text-xs text-gray-500 leading-relaxed mb-8 group-hover:text-gray-400"
              >
                Full read/write capability without network access. Changes are queued locally and
                synchronized automatically when connectivity returns.
              </p>

              <div
                class="mt-auto pt-4 border-t border-[#1a1a1a] flex items-center gap-2 text-[10px] font-mono text-gray-600"
              >
                <span
                  class="w-1.5 h-1.5 rounded-full bg-gray-600 group-hover:bg-green-500 transition-colors"
                ></span>
                <span>STATE: PERSISTED</span>
              </div>
            </div>
          </div>

          <!-- Card 2: Live Updates -->
          <div
            class="group relative bg-[#050505] border border-[#222] p-8 hover:bg-[#0a0a0a] transition-colors duration-500 overflow-hidden"
          >
            <div
              class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-purple-500/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"
            >
            </div>

            <div class="relative z-10 flex flex-col h-full">
              <div class="flex items-start justify-between mb-6">
                <div
                  class="text-[10px] font-mono text-gray-600 uppercase tracking-widest border border-[#333] px-2 py-1 rounded"
                >
                  02_SYNC
                </div>
                <svg
                  class="w-5 h-5 text-gray-600 group-hover:text-purple-400 transition-colors"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
              </div>

              <h3
                class="text-lg font-bold uppercase tracking-wider text-gray-200 mb-3 group-hover:text-white transition-colors"
              >
                Live Updates
              </h3>

              <p
                class="font-mono text-xs text-gray-500 leading-relaxed mb-8 group-hover:text-gray-400"
              >
                Sub-millisecond latency. Data changes propagate instantly to all connected clients
                via incremental view maintenance.
              </p>

              <div
                class="mt-auto pt-4 border-t border-[#1a1a1a] flex items-center gap-2 text-[10px] font-mono text-gray-600"
              >
                <span
                  class="w-1.5 h-1.5 rounded-full bg-gray-600 group-hover:bg-purple-500 transition-colors animate-pulse"
                ></span>
                <span>SOCKET: CONNECTED</span>
              </div>
            </div>
          </div>

          <!-- Card 3: Developer Experience -->
          <div
            class="group relative bg-[#050505] border border-[#222] p-8 hover:bg-[#0a0a0a] transition-colors duration-500 overflow-hidden"
          >
            <div
              class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-blue-500/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"
            >
            </div>

            <div class="relative z-10 flex flex-col h-full">
              <div class="flex items-start justify-between mb-6">
                <div
                  class="text-[10px] font-mono text-gray-600 uppercase tracking-widest border border-[#333] px-2 py-1 rounded"
                >
                  03_DX
                </div>
                <svg
                  class="w-5 h-5 text-gray-600 group-hover:text-blue-400 transition-colors"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                </svg>
              </div>

              <h3
                class="text-lg font-bold uppercase tracking-wider text-gray-200 mb-3 group-hover:text-white transition-colors"
              >
                Developer Experience
              </h3>

              <p
                class="font-mono text-xs text-gray-500 leading-relaxed mb-8 group-hover:text-gray-400"
              >
                Schema-first design with end-to-end type safety. Generated TypeScript definitions
                ensure your code is always correct.
              </p>

              <div
                class="mt-auto pt-4 border-t border-[#1a1a1a] flex items-center gap-2 text-[10px] font-mono text-gray-600"
              >
                <span
                  class="w-1.5 h-1.5 rounded-full bg-gray-600 group-hover:bg-blue-500 transition-colors"
                ></span>
                <span>TYPES: STRICT</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="max-w-7xl mx-auto mt-20 px-4 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <div>
          <h2
            class="text-3xl font-bold mb-6 uppercase decoration-dashed underline underline-offset-8"
          >
            README.md
          </h2>
          <div class="space-y-4 text-sm md:text-base font-mono">
            <p>
              <span class="font-bold text-green-500">user@spooky:~$</span> less README.md
            </p>
            <p class="border-l-2 border-white pl-4 py-2">
              Spooky is a production-ready sync engine designed for modern real-time applications.
              It bypasses traditional REST APIs in favor of direct state synchronization.
            </p>
            <p class="border-l-2 border-white pl-4 py-2">
              Built on SurrealDB, Spooky provides authentication-agnostic security. It allows you to
              integrate with any identity provider while maintaining fine-grained access control.
            </p>
            <div class="mt-8">
              <a
                href="https://github.com/mono424/spooky"
                target="_blank"
                class="inline-block border-2 border-white bg-black text-white px-6 py-2 hover:bg-white hover:text-black transition-none uppercase font-bold"
              >
                [ READ_FULL_DOCS ]
              </a>
            </div>
          </div>
        </div>

        <div class="p-4 flex items-center justify-center bg-black">
          <ArchitectureDiagram client:visible />
        </div>
      </div>
    </section>

    <!-- SECTION 1: SCHEMA & TYPES -->
    <section class="py-24 relative">
      <div
        class="absolute inset-0 opacity-[0.03] pointer-events-none"
        style="background-image: linear-gradient(to right, #ffffff 1px, transparent 1px), linear-gradient(to bottom, #ffffff 1px, transparent 1px); background-size: 40px 40px;"
      >
      </div>

      <div class="max-w-7xl mx-auto px-4 relative z-10">
        <SectionHeadline
          title="SCHEMA_FIRST"
          description='Your database is your <span class="text-white">source of truth</span>. We introspect your schema to generate <span class="text-purple-400">strict TypeScript definitions</span> automatically.'
        />

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
          <div class="lg:col-span-3 space-y-6">
            <div class="border border-[#333] bg-[#0a0a0a] rounded-sm p-4 h-full min-h-[400px]">
              <div
                class="text-[10px] uppercase tracking-widest text-gray-500 mb-4 font-bold border-b border-[#222] pb-2"
              >
                Project Explorer
              </div>
              <div class="font-mono text-sm space-y-1">
                <div class="text-gray-400 flex items-center gap-2">
                  <span class="text-gray-600">‚ñæ</span> üìÅ apps
                </div>
                <div class="pl-4 text-gray-500 border-l border-[#222] ml-1">
                  <div class="py-1 cursor-pointer transition-colors">üìÅ solid-app</div>
                  <div class="pl-4 border-l border-[#222] ml-1">
                    <div class="py-1 cursor-pointer transition-colors">üìÅ src</div>
                    <div class="py-1 text-purple-400 group flex items-center justify-between">
                      <span>‚ö° schema.gen.ts</span>
                    </div>
                    <div class="py-1 text-gray-600">‚öôÔ∏è package.json</div>
                  </div>
                  <div class="py-1 cursor-pointer transition-colors block">üìÅ flutter-app</div>
                </div>

                <div class="text-gray-400 flex items-center gap-2 mt-2">
                  <span class="text-gray-600">‚ñæ</span> üìÅ packages
                </div>
                <div class="pl-4 border-l border-[#222] ml-1">
                  <div class="py-1 text-gray-500">üìÅ schema</div>
                  <div class="pl-4 border-l border-[#222] ml-1">
                    <div
                      class="py-1 text-green-400 bg-green-900/20 -mx-2 px-2 rounded flex justify-between items-center group cursor-pointer"
                    >
                      <span>‚ö° schema.surql</span>
                    </div>
                    <div class="py-1 text-gray-600">‚öôÔ∏è package.json</div>
                  </div>
                </div>
              </div>

              <div class="mt-8 text-xs text-gray-500 border-t border-[#222] pt-4 leading-relaxed">
                <span class="text-green-500 font-bold">TIP:</span> Add a pre-commit hook to automatically
                update all types on schema change.
              </div>
            </div>
          </div>

          <div class="lg:col-span-9">
            <SchemaGenerator client:visible />
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 2: REMOTE QUERYING -->
    <section class="py-24 border-b border-white/10 relative">
      <div
        class="absolute inset-0 opacity-[0.03] pointer-events-none"
        style="background-image: linear-gradient(to right, #ffffff 1px, transparent 1px), linear-gradient(to bottom, #ffffff 1px, transparent 1px); background-size: 40px 40px;"
      >
      </div>

      <div class="max-w-7xl mx-auto px-4 relative z-10">
        <SectionHeadline
          title="DEV_EXPERIENCE"
          description='Spooky is built by <span class="text-white">developers for developers</span> with framework-native queries with <span class="text-blue-400">full reactivity</span> and type safety.'
        />

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
          <div class="order-2 lg:order-1">
            <LiveCodeEditor client:visible filename="ThreadList.tsx" initialCode={solidQueryCode} />
          </div>
          <div class="order-1 lg:order-2 font-mono">
            <div class="mb-4 relative overflow-hidden group">
              <!-- Decorative background glow -->
              <div
                class="absolute -right-10 -bottom-10 w-32 h-32 bg-blue-500/5 blur-3xl rounded-full pointer-events-none"
              >
              </div>

              <div class="border border-[#222] bg-[#080808] p-5 relative z-10">
                <div class="flex items-center gap-3 mb-4">
                  <div
                    class="w-8 h-8 bg-blue-900/10 border border-blue-500/20 flex items-center justify-center text-blue-500"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path
                        d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"
                      ></path>
                      <path d="M5 3v4"></path>
                      <path d="M9 3v4"></path>
                      <path d="M3 5h4"></path>
                      <path d="M3 9h4"></path>
                    </svg>
                  </div>
                  <div>
                    <div
                      class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-0.5"
                    >
                      INTELLISENSE_EVERYWHERE
                    </div>
                    <div class="text-sm font-bold text-white uppercase">
                      Context-Aware Autocomplete
                    </div>
                  </div>
                </div>

                <p class="text-xs text-gray-400 font-mono leading-relaxed">
                  Context-aware autocomplete knows your schema inside out. It suggests sort fields,
                  relations, and filter operations appropriate for your current query context.
                </p>
              </div>
            </div>
            <div class="mt-8 relative overflow-hidden group">
              <!-- Decorative background glow -->
              <div
                class="absolute -right-10 -bottom-10 w-32 h-32 bg-green-500/5 blur-3xl rounded-full pointer-events-none"
              >
              </div>

              <div class="border border-[#222] bg-[#080808] p-5 relative z-10">
                <div class="flex items-center gap-3 mb-4">
                  <div
                    class="w-8 h-8 bg-yellow-900/10 border border-yellow-500/20 flex items-center justify-center text-yellow-500"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path
                        d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"
                      ></path><path d="M9 18h6"></path><path d="M10 22h4"></path>
                    </svg>
                  </div>
                  <div>
                    <div
                      class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-0.5"
                    >
                      TYPESAFETY_EVERYWHERE
                    </div>
                    <div class="text-sm font-bold text-white uppercase">Real-Time Feedback</div>
                  </div>
                </div>

                <p class="text-xs text-gray-400 font-mono mb-4 leading-relaxed">
                  Your queries are continuously validated against your schema. Type mismatches,
                  invalid fields, and logic errors are detected instantly and highlighted directly
                  inside the code editor, ensuring your code is correct before execution. Try
                  yourself and fix the type error on the left.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- DEVTOOLS SIMULATION SUBSECTION -->
      <div class="max-w-7xl mx-auto px-4 mt-24">
        <div class="flex flex-col lg:flex-row gap-12 items-center">
          <!-- DevTools Component (Fixed Width / Main Column) -->
          <div class="w-full lg:w-2/3 shadow-2xl">
            <DevToolsSimulation client:visible />
          </div>

          <!-- Description Sidebar -->
          <div class="w-full lg:w-1/3">
            <div class="mb-6">
              <div
                class="inline-block border border-purple-500/30 bg-purple-900/10 px-3 py-1 rounded text-[10px] font-bold text-purple-400 uppercase tracking-widest mb-4"
              >
                DevTools
              </div>
              <h3 class="text-2xl font-bold uppercase tracking-widest text-white mb-4">
                Peek Under the Hood
              </h3>
              <p class="font-mono text-gray-500 text-sm leading-relaxed">
                Stop guessing what your application is doing. Spooky provides a complete suite of
                tools embedded directly in your browser.
              </p>
            </div>

            <div class="space-y-6 font-mono text-xs">
              <div class="group">
                <h4
                  class="text-white font-bold mb-1 group-hover:text-blue-400 transition-colors flex items-center gap-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    ><path d="M21 11V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6"
                    ></path><path d="m12 12 4 10 1.7-4.3L22 16Z"></path></svg
                  >
                  > LIVE_INSPECTION
                </h4>
                <p class="text-gray-600">
                  View your local database state in real-time as it changes. No more console.logging
                  state.
                </p>
              </div>

              <div class="group">
                <h4
                  class="text-white font-bold mb-1 group-hover:text-green-400 transition-colors flex items-center gap-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    ><path d="M12 2v4"></path><path d="m16.2 7.8 2.9-2.9"></path><path d="M18 12h4"
                    ></path><path d="m16.2 16.2 2.9 2.9"></path><path d="M12 18v4"></path><path
                      d="m4.9 19.1 2.9-2.9"></path><path d="M2 12h4"></path><path
                      d="m4.9 4.9 2.9 2.9"></path></svg
                  >
                  > QUERY_MONITOR
                </h4>
                <p class="text-gray-600">
                  Track active subscriptions, latency metrics, and data transfer sizes for
                  optimization.
                </p>
              </div>

              <div class="group">
                <h4
                  class="text-white font-bold mb-1 group-hover:text-yellow-400 transition-colors flex items-center gap-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    ><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"
                    ></polyline></svg
                  >
                  > EVENTS_TIMELINE
                </h4>
                <p class="text-gray-600">
                  Track every state change, network request, and incantation registration in a
                  detailed, chronological timeline.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 3: UNDER THE HOOD -->
    <section class="py-24 border-b border-white/10 bg-black">
      <div class="max-w-7xl mx-auto px-4">
        <SectionHeadline
          title="UNDER_THE_HOOD"
          description='Spooky uses <span class="text-white">Icremental View Maintanence</span> to track client query hashes, known as <span class="text-purple-400 font-bold">Incantations</span>. These are stored in the <code class="bg-[#222] px-1 py-0.5 rounded text-gray-300">_spooky_querys</code> table. Choose your runtime based on your performance needs.'
        />

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto mb-24">
          <div
            class="group border border-[#333] bg-[#0a0a0a] hover:border-purple-500/30 transition-colors duration-300 relative overflow-hidden rounded-sm flex flex-col"
          >
            <div
              class="absolute top-0 left-0 bg-[#222] text-[10px] font-bold px-3 py-1 text-gray-400 border-r border-b border-[#333] uppercase tracking-wider"
            >
              Mode_A
            </div>

            <div class="p-8 pt-12 flex-1 flex flex-col">
              <div class="flex justify-between items-baseline mb-6">
                <h3 class="text-xl font-bold text-white">Surrealism (WASM)</h3>
                <span
                  class="text-[10px] font-bold font-mono text-black bg-purple-400 px-2 py-1 rounded-sm uppercase"
                  >Local / Testing</span
                >
              </div>

              <div class="w-full flex flex-col gap-4 font-mono mb-8">
                <!-- CLIENTS LAYER -->
                <div class="flex justify-center gap-10 relative z-10">
                  <div class="flex flex-col items-center gap-1 group/client">
                    <div
                      class="h-8 w-8 border border-gray-600 rounded bg-[#111] flex items-center justify-center text-gray-400 group-hover/client:border-white group-hover/client:text-white transition-colors"
                    >
                      <span class="text-[10px]">DEV</span>
                    </div>
                    <span class="text-[8px] text-gray-600">Developer</span>
                    <div
                      class="w-[1px] h-full bg-gradient-to-b from-transparent via-gray-700 to-gray-700"
                    >
                    </div>
                  </div>
                  <div class="flex flex-col items-center gap-1 group/client">
                    <div
                      class="h-8 w-8 border border-gray-600 rounded bg-[#111] flex items-center justify-center text-gray-400 group-hover/client:border-white group-hover/client:text-white transition-colors"
                    >
                      <span class="text-[10px]">TEST</span>
                    </div>
                    <span class="text-[8px] text-gray-600">Vitest</span>
                    <div
                      class="w-[1px] h-full bg-gradient-to-b from-transparent via-gray-700 to-gray-700"
                    >
                    </div>
                  </div>
                </div>

                <!-- INFRASTRUCTURE BOX -->
                <div
                  class="border border-dashed border-[#333] p-3 rounded bg-[#0f0f0f] relative mt-2"
                >
                  <div
                    class="absolute -top-2 left-3 bg-[#0f0f0f] px-1 text-[8px] text-gray-500 font-bold uppercase tracking-wider"
                  >
                    Local Infrastructure
                  </div>

                  <div class="flex gap-2">
                    <!-- SURREALDB CONTAINER -->
                    <div
                      class="flex-1 border border-purple-900/40 bg-purple-900/5 p-2 rounded flex flex-col gap-2 relative overflow-hidden mb-9"
                    >
                      <div
                        class="flex items-center justify-between border-b border-purple-900/20 pb-1 relative z-10"
                      >
                        <span class="text-[9px] font-bold text-purple-400">SURREALDB</span>
                        <span class="h-1.5 w-1.5 rounded-full bg-purple-500 animate-pulse"></span>
                      </div>

                      <!-- EMBEDDED WASM -->
                      <div
                        class="bg-black/50 border border-purple-500/30 p-2 rounded relative z-10"
                      >
                        <div class="flex justify-between items-center mb-1">
                          <span class="text-[8px] font-bold text-gray-300"
                            >Spooky Stream Processor (WASM)</span
                          >
                          <span class="text-[8px] text-orange-400">Ephemeral</span>
                        </div>
                        <div class="h-1 w-full bg-gray-800 rounded overflow-hidden">
                          <div class="h-full bg-purple-500/50 w-full animate-pulse"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="mt-auto">
                <p class="text-xs text-gray-500 mb-4 font-mono leading-relaxed">
                  The Spooky Stream Processor executes directly within SurrealDB‚Äîideal for <span
                    class="text-gray-300">automated testing scenarios</span
                  >, CI/CD pipelines, and local development.
                </p>
                <ul class="space-y-2 font-mono text-xs text-gray-500 border-t border-[#222] pt-4">
                  <li class="flex items-start gap-2">
                    <span class="text-purple-400">‚úî</span> Zero setup (runs inside `surreal start`).
                  </li>
                  <li class="flex items-start gap-2">
                    <span class="text-orange-400">‚ö†</span>
                    <span
                      class="relative group/tooltip cursor-help border-b border-dotted border-gray-600"
                    >
                      High I/O overhead (State Rehydration).
                      <div
                        class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-64 p-3 bg-[#111] border border-[#333] text-[10px] text-gray-400 opacity-0 group-hover/tooltip:opacity-100 transition-opacity pointer-events-none z-50 shadow-xl rounded font-normal normal-case"
                      >
                        The DBSP processor runs as an embedded WASM function. Since WASM memory is
                        ephemeral, the entire state must be loaded and saved to the database on
                        every execution.
                        <div
                          class="absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-[#333]"
                        >
                        </div>
                      </div>
                    </span>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <div
            class="group border border-[#333] bg-[#0a0a0a] hover:border-green-500/30 transition-colors duration-300 relative overflow-hidden rounded-sm flex flex-col"
          >
            <div
              class="absolute top-0 left-0 bg-[#222] text-[10px] font-bold px-3 py-1 text-gray-400 border-r border-b border-[#333] uppercase tracking-wider"
            >
              Mode_B
            </div>

            <div class="p-8 pt-12 flex-1 flex flex-col">
              <div class="flex justify-between items-baseline mb-6">
                <h3 class="text-xl font-bold text-white">Sidecar Daemon</h3>
                <span
                  class="text-[10px] font-bold font-mono text-black bg-green-500 px-2 py-1 rounded-sm uppercase"
                  >Production</span
                >
              </div>

              <div class="w-full flex flex-col gap-4 font-mono mb-8">
                <!-- CLIENTS LAYER -->
                <div class="flex justify-center gap-8 relative z-10">
                  <div class="flex flex-col items-center gap-1 group/client">
                    <div
                      class="h-8 w-8 border border-gray-600 rounded bg-[#111] flex items-center justify-center text-gray-400 group-hover/client:border-white group-hover/client:text-white transition-colors"
                    >
                      <span class="text-[10px]">WEB</span>
                    </div>
                    <span class="text-[8px] text-gray-600">React/Solid</span>
                    <div
                      class="w-[1px] h-full bg-gradient-to-b from-transparent via-gray-700 to-gray-700"
                    >
                    </div>
                  </div>
                  <div class="flex flex-col items-center gap-1 group/client">
                    <div
                      class="h-8 w-8 border border-gray-600 rounded bg-[#111] flex items-center justify-center text-gray-400 group-hover/client:border-white group-hover/client:text-white transition-colors"
                    >
                      <span class="text-[10px]">APP</span>
                    </div>
                    <span class="text-[8px] text-gray-600">Flutter/iOS</span>
                    <div
                      class="w-[1px] h-full bg-gradient-to-b from-transparent via-gray-700 to-gray-700"
                    >
                    </div>
                  </div>
                </div>

                <!-- INFRASTRUCTURE BOX -->
                <div
                  class="border border-dashed border-[#333] p-3 rounded bg-[#0f0f0f] relative mt-2"
                >
                  <div
                    class="absolute -top-2 left-3 bg-[#0f0f0f] px-1 text-[8px] text-gray-500 font-bold uppercase tracking-wider"
                  >
                    Server Infrastructure
                  </div>

                  <div class="flex gap-2">
                    <!-- SURREALDB NODE -->
                    <div
                      class="flex-1 border border-blue-900/40 bg-blue-900/5 p-2 rounded flex flex-col gap-2"
                    >
                      <div
                        class="flex items-center justify-between border-b border-blue-900/20 pb-1"
                      >
                        <span class="text-[9px] font-bold text-blue-400">SURREALDB</span>
                        <span class="h-1.5 w-1.5 rounded-full bg-blue-500 animate-pulse"></span>
                      </div>
                      <div class="space-y-1">
                        <div
                          class="bg-blue-900/10 border border-blue-900/20 px-1.5 py-1 rounded text-[8px] text-blue-200/70"
                        >
                          Tables & Auth
                        </div>
                        <div
                          class="bg-blue-900/10 border border-blue-900/20 px-1.5 py-1 rounded text-[8px] text-blue-200/70"
                        >
                          Live Query Hub
                        </div>
                        <div
                          class="bg-blue-900/10 border border-blue-900/20 px-1.5 py-1 rounded text-[8px] text-blue-200/70"
                        >
                          Event Triggers
                        </div>
                      </div>
                    </div>

                    <!-- RPC CONNECT -->
                    <div
                      class="flex flex-col justify-center items-center gap-0.5 text-[8px] text-gray-600 w-8 shrink-0"
                    >
                      <span>RPC</span>
                      <div class="w-full h-[1px] bg-gray-700"></div>
                      <span>SYNC</span>
                    </div>

                    <!-- SIDECAR NODE -->
                    <div
                      class="flex-1 border border-green-900/40 bg-green-900/10 p-2 rounded shadow-[0_0_20px_rgba(22,197,94,0.05)] flex flex-col gap-2"
                    >
                      <div
                        class="flex items-center justify-between border-b border-green-900/20 pb-1"
                      >
                        <span class="text-[9px] font-bold text-green-400">SIDECAR</span>
                        <span
                          class="h-1.5 w-1.5 rounded-full bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.8)]"
                        ></span>
                      </div>
                      <div class="space-y-1">
                        <div
                          class="bg-green-900/20 border border-green-900/30 px-1.5 py-1 rounded text-[8px] text-green-200/80 font-bold flex items-center gap-1"
                        >
                          <span>‚ö°</span> DBSP Engine
                        </div>
                        <div
                          class="bg-green-900/20 border border-green-900/30 px-1.5 py-1 rounded text-[8px] text-green-200/80"
                        >
                          Incantation Mgr
                        </div>
                        <div
                          class="bg-green-900/20 border border-green-900/30 px-1.5 py-1 rounded text-[8px] text-green-200/80"
                        >
                          In-Memory State
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="mt-auto">
                <p class="text-xs text-gray-500 mb-4 font-mono leading-relaxed">
                  The Sidecar runs as a separate process. It keeps the DBSP state in <span
                    class="text-gray-300">RAM</span
                  >, eliminating the need to save/load state on every request. It updates the
                  database via RPC.
                </p>
                <ul class="space-y-2 font-mono text-xs text-gray-500 border-t border-[#222] pt-4">
                  <li class="flex items-start gap-2">
                    <span class="text-green-400">‚úî</span> High Performance (In-Memory State).
                  </li>
                  <li class="flex items-start gap-2">
                    <span class="text-green-400">‚úî</span> Scalable for production loads.
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        {
          /* <!-- MERKLE TREE SUBSECTION (Merged) -->
        <div class="pt-16 mb-12">
          <div class="flex flex-col lg:flex-row gap-12 items-center">
            <!-- Merkle Tree Animation (Left Column) -->
            <div class="w-full lg:w-1/2">
              <MerkleTree client:visible />
            </div>

            <!-- Description & Dashboard (Right Column) -->
            <div class="w-full lg:w-1/2 flex flex-col gap-8">
              <div>
                <div
                  class="inline-block border border-[#333] bg-black px-3 py-1.5 rounded-[2px] text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-6 shadow-sm"
                >
                  Cryptographic_Truth
                </div>
                <p class="font-mono text-gray-500 text-sm leading-relaxed">
                  Every query result is backed by a <span class="text-white font-bold"
                    >Merkle Tree</span
                  >. Changes bubble up deterministically, ensuring <span
                    class="text-purple-400 font-bold">data consistency</span
                  > across all clients.
                </p>
              </div>

              <!-- Dashboard below description -->
              <MerkleDashboard client:visible />
            </div>
          </div>
        </div> */
        }
      </div>

      <!-- CTA SECTION -->
      <section class="py-32 border-t border-white/10 bg-black text-center relative overflow-hidden">
        <!-- Decorative background glow -->
        <div
          class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/10 blur-[100px] rounded-full pointer-events-none"
        >
        </div>

        <div class="max-w-4xl mx-auto px-4 relative z-10">
          <h2 class="text-4xl md:text-5xl font-bold uppercase tracking-widest mb-8 text-white">
            Ready to Get Spooky?
          </h2>
          <p class="font-mono text-gray-500 mb-12 max-w-2xl mx-auto leading-relaxed">
            Start building local-first, offline-ready applications today. Dive into the
            documentation to learn more about the architecture and implementation details.
          </p>
          <a
            href={`${process.env.ASTRO_BASE_PATH}/docs`}
            class="inline-block border-2 border-white bg-white text-black px-12 py-4 hover:bg-black hover:text-white transition-none uppercase font-bold text-lg tracking-widest"
          >
            [ START_BUILDING ]
          </a>
        </div>
      </section>

      <footer class="py-12 border-t-4 border-white border-double">
        <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center">
          <div class="mb-4 md:mb-0 text-xs font-mono flex items-center relative">
            <img src="/spooky/logo_transparent.svg" alt="Spooky Logo" class="w-4 h-4 mr-2" />
            ¬© 2025 SPOOKY
          </div>
          <div class="space-x-6 text-sm font-mono uppercase">
            <a href="#" class="hover:underline px-1 transition-none">[ PRIVACY ]</a>
            <a href="#" class="hover:underline px-1 transition-none">[ TERMS ]</a>
            <a href="#" class="hover:underline px-1 transition-none">[ EXIT ]</a>
          </div>
        </div>
      </footer>
    </section>

    <script>
      // 1. Define the Ghost SVG (Static version, we animate the position manually)
      const ghostSVG = `
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="none">
      <style>
        .bg { fill: #FFFFFF; }
        .ghost { fill: #000000; }
        .eyes { fill: #FFFFFF; }
        @media (prefers-color-scheme: dark) {
          .bg { fill: #000000; }
          .ghost { fill: #FFFFFF; }
          .eyes { fill: #000000; }
        }
      </style>
      <path class="ghost" d="M6 10V28L10 24L14 28L18 24L22 28L26 24V10C26 4.47715 21.5228 0 16 0C10.4772 0 6 4.47715 6 10Z"/>
      <rect class="eyes" x="10" y="8" width="4" height="4"/>
      <rect class="eyes" x="18" y="8" width="4" height="4"/>
    </svg>`;

      // 2. Setup the Canvas and Image
      const canvas = document.createElement('canvas');
      canvas.width = 32;
      canvas.height = 32;
      const ctx = canvas.getContext('2d');

      const img = new Image();
      // Encode SVG so it can be used as an image source
      img.src = 'data:image/svg+xml;base64,' + btoa(ghostSVG);

      // 3. Find (or create) the favicon link tag
      let link = document.querySelector("link[rel~='icon']") as HTMLLinkElement;
      if (!link) {
        link = document.createElement('link');
        link.rel = 'icon';
        document.head.appendChild(link);
      }

      // 4. The Animation Loop
      img.onload = function () {
        let start = performance.now();

        function step(timestamp: number) {
          // Calculate the "float" (Sine wave)
          const elapsed = timestamp - start;
          // Speed: 3000ms (3s) for full loop
          // Movement: Moves between 0px and 3px down
          const yOffset = (1 - Math.cos((elapsed / 3000) * 2 * Math.PI)) * 1.5;

          // Clear and Draw
          ctx?.clearRect(0, 0, 32, 32);
          // Draw image at the new Y position
          ctx?.drawImage(img, 0, yOffset, 32, 32);

          // Update the browser favicon
          link.href = canvas.toDataURL('image/png');

          // Repeat
          requestAnimationFrame(step);
        }
        requestAnimationFrame(step);
      };
    </script>
  </body>
</html>
