import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as f}from"./index.DPYYMTZ4.js";import"./_commonjsHelpers.CqkleIqs.js";const c={TABLES:[{label:"user",kind:"table",type:"SCHEMAFULL",doc:"System users and authentication details."},{label:"thread",kind:"table",type:"SCHEMAFULL",doc:"Root collection for discussion threads. Contains title, body, and author references."},{label:"notification",kind:"table",type:"SCHEMAFULL",doc:"User activity alerts."}],RELATIONS:[{label:"author",kind:"relation",type:"record<user>",doc:"The creator of the thread."},{label:"comments",kind:"relation",type:"array<comment>",doc:"Replies to this thread."},{label:"categories",kind:"relation",type:"array<category>",doc:"Tags associated with thread."}],ORDER_FIELDS:[{label:"created_at",kind:"field",type:"datetime",doc:"Creation timestamp."},{label:"updated_at",kind:"field",type:"datetime",doc:"Last modification."},{label:"title",kind:"field",type:"string",doc:"Alphabetical sort."},{label:"score",kind:"field",type:"int",doc:"Popularity metric."}],DIRECTIONS:[{label:"asc",kind:"keyword",doc:"Ascending (A-Z, 0-9)."},{label:"desc",kind:"keyword",doc:"Descending (Z-A, 9-0)."}]},y=o=>c.TABLES.find(s=>s.label===o)?{options:c.TABLES,title:"Table Schema",isReadOnly:!0}:c.RELATIONS.find(s=>s.label===o)?{options:c.RELATIONS,title:"Select Relation",isReadOnly:!1}:c.ORDER_FIELDS.find(s=>s.label===o)?{options:c.ORDER_FIELDS,title:"Order By",isReadOnly:!1}:c.DIRECTIONS.find(s=>s.label===o)?{options:c.DIRECTIONS,title:"Direction",isReadOnly:!1}:null,j={field:e.jsx("svg",{className:"w-3 h-3 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),table:e.jsx("svg",{className:"w-3 h-3 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7-4h14M2 5h20v14H2V5z"})}),relation:e.jsx("svg",{className:"w-3 h-3 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),keyword:e.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),error:e.jsx("svg",{className:"w-3 h-3 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})},N=({text:o,className:s,cleanText:a,onReplace:g})=>{const[x,h]=f.useState(!1),u=f.useRef(null),d=y(a);if(!d)return e.jsx("span",{className:s,dangerouslySetInnerHTML:{__html:o}});const m=d.options.find(t=>t.label===a),i=()=>{u.current&&window.clearTimeout(u.current),h(!0)},l=()=>{u.current=window.setTimeout(()=>{h(!1)},150)},n=x?"z-[9999] relative":"z-auto relative";return d.isReadOnly?e.jsxs("span",{className:`${s} inline-block ${n}`,onMouseEnter:i,onMouseLeave:l,children:[e.jsx("span",{className:"absolute inset-0 -bottom-2 bg-transparent z-10"}),e.jsx("span",{className:"cursor-help decoration-dotted underline decoration-white/30 underline-offset-4 hover:decoration-white/60 hover:text-white transition-all relative z-20",dangerouslySetInnerHTML:{__html:o}}),x&&e.jsxs("div",{className:"absolute left-0 top-full mt-1 w-[280px] bg-[#1a1a1a] border border-[#333] shadow-[0_8px_32px_rgba(0,0,0,0.9)] rounded-sm font-mono text-xs animate-in fade-in slide-in-from-top-1 duration-150 pointer-events-auto cursor-default z-30",children:[e.jsxs("div",{className:"bg-[#111] px-3 py-2 border-b border-[#222] flex items-center gap-2",children:[j[m?.kind||"table"],e.jsx("span",{className:"font-bold text-gray-200",children:a}),e.jsx("span",{className:"text-[10px] text-orange-400 bg-orange-400/10 px-1.5 rounded border border-orange-400/20 ml-auto",children:m?.type})]}),e.jsx("div",{className:"p-3 text-gray-400 leading-relaxed whitespace-normal break-words",children:m?.doc}),e.jsxs("div",{className:"bg-[#111] px-3 py-1.5 border-t border-[#222] text-[10px] text-gray-600",children:[e.jsx("span",{className:"text-blue-500",children:"★"})," Primary Key:"," ",e.jsx("span",{className:"text-gray-400",children:"id"})]})]})]}):e.jsxs("span",{className:`${s} inline-block ${n}`,onMouseEnter:i,onMouseLeave:l,children:[e.jsx("span",{className:"absolute inset-0 -bottom-2 bg-transparent z-10"}),e.jsx("span",{className:"cursor-pointer border-b border-dashed border-green-500/40 bg-green-500/5 hover:bg-green-500/10 hover:border-green-400 transition-colors rounded-sm px-0.5 relative z-20",dangerouslySetInnerHTML:{__html:o}}),x&&e.jsxs("div",{className:"absolute left-0 top-full mt-1 min-w-[240px] bg-[#1a1a1a] border border-[#333] shadow-[0_8px_32px_rgba(0,0,0,0.8)] rounded-sm font-mono text-xs animate-in fade-in zoom-in-95 duration-100 overflow-hidden pointer-events-auto z-30",children:[e.jsxs("div",{className:"bg-[#111] px-3 py-1.5 text-[10px] text-gray-500 border-b border-[#222] flex justify-between items-center uppercase tracking-wider shrink-0",children:[e.jsx("span",{className:"font-bold text-gray-400",children:d.title}),e.jsx("span",{className:"bg-[#222] px-1 rounded text-[9px]",children:"Tab ↹"})]}),e.jsx("div",{className:"py-1",children:d.options.map(t=>{const b=t.label===a;return e.jsxs("button",{onClick:r=>{r.stopPropagation(),g(a,t.label),h(!1)},className:`w-full text-left px-3 py-2 flex justify-between items-center group transition-colors ${b?"bg-[#0f2e1a] text-white border-l-2 border-green-500":"text-gray-400 border-l-2 border-transparent hover:bg-[#222] hover:text-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-80 shrink-0",children:j[t.kind]}),e.jsx("span",{className:b?"font-bold":"",children:t.label})]}),t.type&&e.jsx("span",{className:`text-[10px] ml-2 ${b?"text-green-400":"text-gray-600"}`,children:t.type})]},t.label)})}),d.options.find(t=>t.label===a)?.doc&&e.jsxs("div",{className:"bg-[#111] border-t border-[#222] p-2 text-gray-500 text-[10px] leading-relaxed whitespace-normal break-words",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"INFO: "}),d.options.find(t=>t.label===a)?.doc]})]})]})},v=({text:o})=>{const[s,a]=f.useState(!1);return e.jsxs("span",{className:`group relative cursor-pointer inline-block ${s?"z-[9999]":"z-auto"}`,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[e.jsx("span",{className:"text-gray-300 decoration-wavy underline decoration-red-500 underline-offset-2 relative z-20",children:o}),s&&e.jsxs("div",{className:"absolute left-0 bottom-full mb-1 w-[300px] bg-[#1a1a1a] border border-red-500/50 shadow-2xl rounded-sm font-mono text-xs z-[100] animate-in fade-in slide-in-from-bottom-1 pointer-events-auto",children:[e.jsxs("div",{className:"bg-red-500/10 px-3 py-2 border-b border-red-500/20 flex items-center gap-2 text-red-400",children:[j.error,e.jsx("span",{className:"font-bold",children:"Property 'author' does not exist"})]}),e.jsxs("div",{className:"p-3 text-gray-400 leading-relaxed whitespace-normal break-words",children:["Type ",e.jsx("span",{className:"text-orange-300",children:"Thread"})," has no property"," ",e.jsx("span",{className:"text-white",children:"author"}),". Did you forget to include"," ",e.jsx("span",{className:"bg-[#222] px-1 text-blue-300",children:'.related("author")'})," in your query?"]})]})]})},R=({initialCode:o,filename:s})=>{const[a,g]=f.useState(o),[x,h]=f.useState("comments"),u=(i,l)=>{g(n=>n.replace(`"${i}"`,`"${l}"`)),c.RELATIONS.find(n=>n.label===i)&&h(l)},d=i=>i.split(/(".*?"|\/\/.*$)/gm).map((n,t)=>{if(n.startsWith('"')){const r=n.slice(1,-1),p=n.replace(/</g,"&lt;").replace(/>/g,"&gt;");return e.jsx(N,{text:p,className:"text-orange-300",cleanText:r,onReplace:u},t)}if(n.startsWith("//"))return e.jsx("span",{className:"text-gray-500 italic",children:n},t);const b=n.split(/(thread\.author\.username|\b(?:useQuery|db|query|related|orderBy|limit|build|import|export|from|const|return|function|default|type)\b|[{}[\]().,;]|\s+)/g);return e.jsx("span",{children:b.map((r,p)=>r?r==="thread.author.username"?x!=="author"?e.jsx(v,{text:"thread.author.username"},p):e.jsxs("span",{children:[e.jsx("span",{className:"text-gray-300",children:"thread"}),e.jsx("span",{className:"text-gray-500",children:"."}),e.jsx("span",{className:"text-gray-300",children:"author"}),e.jsx("span",{className:"text-gray-500",children:"."}),e.jsx("span",{className:"text-gray-300",children:"username"})]},p):r.match(/\b(import|export|from|const|return|function|default|type)\b/)?e.jsx("span",{className:"text-purple-400 font-bold",children:r},p):r.match(/\b(useQuery|db|query|related|orderBy|limit|build)\b/)?e.jsx("span",{className:"text-blue-400",children:r},p):r.match(/<[A-Z][a-zA-Z]*|<div|<span|<p\b/)||r.match(/<\/[A-Za-z]+>/)?e.jsx("span",{className:"text-yellow-300",children:r},p):r.match(/[{}[\]().,;]/)||r.match(/[<>]/)?e.jsx("span",{className:"text-gray-500",children:r},p):r:null)},t)}),m=a.split(`
`).length;return e.jsxs("div",{className:"border border-[#333] bg-[#050505] shadow-2xl flex flex-col font-mono text-sm relative overflow-visible group rounded-sm min-h-[420px]",children:[e.jsxs("div",{className:"flex justify-between items-center bg-[#111] border-b border-[#222] px-4 pt-2 text-xs select-none",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1.5 pb-1",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#333]"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#333]"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#333]"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300 bg-[#050505] px-3 py-1 border-t-2 border-green-700 ml-4",children:[e.jsx("span",{className:"font-bold text-blue-400",children:"TSX"}),e.jsx("span",{children:s||"Untitled"})]})]}),e.jsx("div",{className:`text-[10px] font-bold px-2 py-0.5 rounded transition-colors ${x!=="author"?"bg-red-900/20 text-red-500":"text-green-900/0"}`,children:x!=="author"?"1 ERROR":""})]}),e.jsx("div",{className:"relative flex-1 bg-[#050505] overflow-visible min-h-0 font-mono text-sm leading-relaxed",children:a.split(`
`).map((i,l)=>e.jsxs("div",{className:`flex ${l===0?"pt-4":""} ${l===a.split(`
`).length-1?"pb-4":""}`,children:[e.jsx("div",{className:"bg-[#0a0a0a] border-r border-[#222] text-[#444] text-right pr-3 pl-2 select-none w-12 shrink-0",children:l+1}),e.jsx("div",{className:"flex-1 px-4 whitespace-pre-wrap break-words text-gray-300",children:i.length===0?e.jsx("br",{}):d(i)})]},l))}),e.jsxs("div",{className:`border-t px-4 py-1.5 text-[10px] font-bold relative z-10 flex justify-between items-center transition-colors ${x!=="author"?"bg-red-900/10 border-red-900/50":"bg-[#111] border-[#222]"}`,children:[e.jsx("div",{className:"flex gap-4",children:e.jsx("span",{className:"flex items-center gap-2 text-gray-500",children:"SPOOKY_SYNC"})}),e.jsxs("div",{className:"flex gap-4 text-gray-500",children:[e.jsxs("span",{children:["Ln ",m,", Col ",a.split(`
`).pop()?.length]}),e.jsx("span",{children:"UTF-8"}),e.jsx("span",{children:"TypeScript Solid.js"})]})]})]})};export{R as LiveCodeEditor};
