
> @spooky/tests@0.0.0 test /Users/khadim/dev/spooky/tests
> jest --runInBand surrealdb/dbsp.test.ts

  console.log
    Starting SurrealDB container...

      at getContainer (surrealdb/setup.ts:17:11)


 .d8888b.                                             888 8888888b.  888888b.
d88P  Y88b                                            888 888  'Y88b 888  '88b
Y88b.                                                 888 888    888 888  .88P
 'Y888b.   888  888 888d888 888d888  .d88b.   8888b.  888 888    888 8888888K.
    'Y88b. 888  888 888P'   888P'   d8P  Y8b     '88b 888 888    888 888  'Y88b
      '888 888  888 888     888     88888888 .d888888 888 888    888 888    888
Y88b  d88P Y88b 888 888     888     Y8b.     888  888 888 888  .d88P 888   d88P
 'Y8888P'   'Y88888 888     888      'Y8888  'Y888888 888 8888888P'  8888888P'


[2m2025-12-30T20:54:10.066355Z[0m [32m INFO[0m [2msurrealdb_server::env[0m[2m:[0m Running 3.0.0-alpha.17 for linux on aarch64
[2m2025-12-30T20:54:10.125760Z[0m [34mDEBUG[0m [1minit[0m: [2msurrealdb_server::dbs[0m[2m:[0m Server capabilities: scripting=true, guest_access=true, live_query_notifications=true, allow_funcs=all, deny_funcs=none, allow_net=all, deny_net=none, allow_rpc=all, deny_rpc=none, allow_http=all, deny_http=none, allow_experimental=all, deny_experimental=none, allow_arbitrary_query=all, deny_arbitrary_query=none
[2m2025-12-30T20:54:10.125812Z[0m [32m INFO[0m [1minit[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Starting kvs store in memory
[2m2025-12-30T20:54:10.127939Z[0m [32m INFO[0m [1minit[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Started kvs store in memory
[2m2025-12-30T20:54:10.147766Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"check_version" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:54:10.147786Z[0m [32m INFO[0m [1minit[0m:[1minitialise_defaults[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m This is a new SurrealDB instance. Initialising default namespace 'main' and database 'main'
[2m2025-12-30T20:54:10.147840Z[0m [35mTRACE[0m [1minit[0m:[1minitialise_defaults[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3minput[0m[2m=[0m"\n\t\t\tDEFINE NAMESPACE $namespace COMMENT 'Default namespace generated by SurrealDB'; \n\t\t\tUSE NS $namespace;\n\t\t\tDEFINE DATABASE $database COMMENT 'Default database generated by SurrealDB'; \n\t\t\tDEFINE CONFIG DEFAULT NAMESPACE $namespace DATABASE $database;\n\t\t" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m256[0m
[2m2025-12-30T20:54:10.148915Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"initialise_defaults" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:54:10.148929Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Initialising credentials [3muser[0m[2m=[0mroot
[2m2025-12-30T20:54:10.148968Z[0m [32m INFO[0m [1minit[0m:[1minitialise_credentials[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Credentials were provided, and no root users were found. The root user 'root' will be created
[2m2025-12-30T20:54:10.166601Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"initialise_credentials" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:54:10.166615Z[0m [35mTRACE[0m [1minit[0m:[1minsert_node[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Inserting node in the cluster [3mid[0m[2m=[0mb7f46a39-90a5-4fd3-adc4-a851d9e95efc
[2m2025-12-30T20:54:10.171165Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"Insert node" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:54:10.171179Z[0m [35mTRACE[0m [1minit[0m:[1mexpire_nodes[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Archiving expired nodes in the cluster
[2m2025-12-30T20:54:10.171217Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"Expire nodes" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:54:10.171224Z[0m [35mTRACE[0m [1minit[0m:[1mremove_nodes[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Cleaning up archived nodes in the cluster
[2m2025-12-30T20:54:10.171243Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"Remove nodes" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:54:10.171305Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Updating node registration information every 3s
[2m2025-12-30T20:54:10.171330Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Processing and cleaning archived nodes every 300s
[2m2025-12-30T20:54:10.171327Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Processing and archiving inactive nodes every 15s
[2m2025-12-30T20:54:10.171351Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Running changefeed garbage collection every 30s
[2m2025-12-30T20:54:10.171363Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Running index compaction every 5s
[2m2025-12-30T20:54:10.171559Z[0m [33m WARN[0m [2msurrealdb_server::ntw[0m[2m:[0m ‚ùåüîíIMPORTANT: GraphQL is a pre-release feature with known security flaws. This is not recommended for production use.üîí‚ùå
[2m2025-12-30T20:54:10.171661Z[0m [32m INFO[0m [2msurrealdb::net[0m[2m:[0m Listening for a system shutdown signal.
[2m2025-12-30T20:54:10.171663Z[0m [32m INFO[0m [2msurrealdb::net[0m[2m:[0m Started web server on 0.0.0.0:8000
  console.log
    SurrealDB started on port 56431

      at getContainer (surrealdb/setup.ts:62:11)

[2m2025-12-30T20:54:10.181812Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"21" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"6dd3692c-1e5a-4617-b5a1-97b55d468389" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.182825Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"21" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"6dd3692c-1e5a-4617-b5a1-97b55d468389" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m1[0m
[2m2025-12-30T20:54:10.190571Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"59" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4bc7d9c9-7214-4fea-85f1-5bccd1f59372" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.208278Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::signin[0m[2m:[0m Signing in as root [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"59" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4bc7d9c9-7214-4fea-85f1-5bccd1f59372" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.208378Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"59" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4bc7d9c9-7214-4fea-85f1-5bccd1f59372" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m17[0m
[2m2025-12-30T20:54:10.210791Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"57238634-cbef-44a4-8ef0-c808a0ee918f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.210837Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"57238634-cbef-44a4-8ef0-c808a0ee918f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.210914Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"57238634-cbef-44a4-8ef0-c808a0ee918f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.211011Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"57238634-cbef-44a4-8ef0-c808a0ee918f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.211074Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"57238634-cbef-44a4-8ef0-c808a0ee918f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"REMOVE DATABASE test_db;" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m24[0m
[2m2025-12-30T20:54:10.211358Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"57238634-cbef-44a4-8ef0-c808a0ee918f" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m0[0m
[2m2025-12-30T20:54:10.213190Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5f74cf14-2078-483e-a05b-ef7167ba756a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.213216Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5f74cf14-2078-483e-a05b-ef7167ba756a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.213234Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5f74cf14-2078-483e-a05b-ef7167ba756a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.213272Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5f74cf14-2078-483e-a05b-ef7167ba756a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.213310Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5f74cf14-2078-483e-a05b-ef7167ba756a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"DEFINE DATABASE test_db;" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m24[0m
  console.log
    Loading generated schema from: /Users/khadim/dev/spooky/tests/.spooky/schema.gen.surql

      at createTestDb (surrealdb/setup.ts:100:13)

[2m2025-12-30T20:54:10.214173Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5f74cf14-2078-483e-a05b-ef7167ba756a" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m0[0m
[2m2025-12-30T20:54:10.217253Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.217276Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.217290Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.217334Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.217450Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"-- This file is auto-generated. Do not edit manually.\n-- Generated by syncgen - any changes will be overwritten.\n\n\n-- ==================================================\n-- SURREALISM MODULES\n-- ==================================================\n\n-- Define bucket for module files\nDEFINE BUCKET IF NOT EXISTS modules BACKEND \"file:///modules\";\n\n-- Define the XOR module\nDEFINE MODULE mod::xor AS f\"modules:/xor_module.surli\";\n\n-- Define the DBSP module\nDEFINE MODULE mod::dbsp AS f\"modules:/dbsp_module.surli\";\n\n-- ##################################################################\n-- SCOPES & AUTHENTICATION\n-- ##################################################################\nDEFINE ACCESS account ON DATABASE TYPE RECORD\nSIGNUP {\n  IF string::len($username) <= 3 { THROW \"Username must be longer than 3 characters\" };\n  IF string::len($password) == 0 { THROW \"Password cannot be empty\" };\n\n  LET $existing = (SELECT value id FROM user WHERE username = $username LIMIT 1)[0];\n  IF $existing != NONE { THROW \"Username '\" + <string>$username + \"' is already taken\" };\n\n  LET $u = CREATE user SET username = $username, password = crypto::argon2::generate($password);\n  RETURN $u;\n}\nSIGNIN ( SELECT * FROM user WHERE username = $username AND crypto::argon2::compare(password, $password) )\nDURATION FOR TOKEN 365d, FOR SESSION 365d\n;\n\nDEFINE FUNCTION fn::polyfill::createAccount($username: string, $password: string) {\n  IF string::len($username) <= 3 { THROW \"Username must be longer than 3 characters\" };\n  IF string::len($password) == 0 { THROW \"Password cannot be empty\" };\n\n  LET $existing = (SELECT value id FROM user WHERE username = $username LIMIT 1)[0];\n  IF $existing != NONE { THROW \"Username '\" + <string>$username + \"' is already taken\" };\n\n  LET $u = CREATE user SET username = $username, password = crypto::argon2::generate($password);\n  RETURN $u;\n};\n\n-- ##################################################################\n-- USER TABLE\n-- ##################################################################\n\nDEFINE TABLE user SCHEMAFULL\nPERMISSIONS\n  FOR update, delete WHERE $access = \"account\" AND id = $auth.id\n  FOR create, select WHERE true;\n\nDEFINE FIELD username ON TABLE user TYPE string\nASSERT $value != NONE AND string::len($value) > 3\nPERMISSIONS\n    FOR select WHERE true\n    FOR create WHERE true\n    FOR update WHERE $access = \"account\" AND id = $auth.id;\n    \nDEFINE INDEX unique_username ON TABLE user FIELDS username UNIQUE;\n\nDEFINE FIELD password ON TABLE user TYPE string\nASSERT $value != NONE AND string::len($value) > 0\nPERMISSIONS\n    FOR select WHERE false\n    FOR create WHERE true\n    FOR update WHERE $access = \"account\" AND id = $auth.id;\n\nDEFINE FIELD created_at ON TABLE user TYPE datetime\nVALUE time::now()\nPERMISSIONS\n    FOR select WHERE false\n    FOR create WHERE true\n    FOR update WHERE $access = \"account\" AND id = $auth.id;\n\n-- ##################################################################\n-- THREAD TABLE\n-- ##################################################################\n\nDEFINE TABLE thread SCHEMAFULL\n  PERMISSIONS\n    FOR select WHERE true\n    FOR update, delete, create WHERE $access = \"account\" AND author.id = $auth.id\n;\n\n\nDEFINE FIELD title ON TABLE thread TYPE string\n    ASSERT $value != NONE AND string::len($value) > 0 AND string::len($value) <= 200;\n\nDEFINE FIELD content ON TABLE thread TYPE string\n    ASSERT $value != NONE AND string::len($value) > 0;\n\nDEFINE FIELD author ON TABLE thread TYPE record<user>; -- @parent\n\nDEFINE FIELD created_at ON TABLE thread TYPE datetime\n    VALUE time::now();\n\nDEFINE FIELD active ON TABLE thread TYPE bool VALUE $value OR false;\n\n-- ##################################################################\n-- COMMENT TABLE\n-- ##################################################################\n\nDEFINE TABLE comment SCHEMAFULL\n  PERMISSIONS\n    FOR select WHERE true\n    FOR update, delete, create WHERE $access = \"account\" AND author.id = $auth.id\n;\n\nDEFINE FIELD thread ON TABLE comment TYPE record<thread>; -- @parent\n\nDEFINE FIELD content ON TABLE comment TYPE string\n    ASSERT $value != NONE AND string::len($value) > 0;\n\nDEFINE FIELD author ON TABLE comment TYPE record<user>;\n\nDEFINE FIELD created_at ON TABLE comment TYPE datetime\n    VALUE time::now();\n\n-- ##################################################################\n-- RELATION TABLES\n-- ##################################################################\n\nDEFINE TABLE commented_on SCHEMAFULL TYPE RELATION\n  FROM comment TO thread\n  PERMISSIONS FOR select WHERE true;\n\nDEFINE EVENT comment_created ON TABLE comment WHEN $event = \"CREATE\" THEN\n  RELATE ($after.id)->commented_on->($after.thread)\n;\n-- ==================================================\n-- SPOOKY INCANTATION\n-- The Registry of active Live Queries (Incantations).\n-- ==================================================\n\nDEFINE TABLE _spooky_incantation SCHEMALESS\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The raw query string (for re-hydration/debugging)\n-- The raw query string (for re-hydration/debugging)\nDEFINE FIELD surrealQL ON TABLE _spooky_incantation TYPE option<string>\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The raw query string (for re-hydration/debugging)\nDEFINE FIELD clientId ON TABLE _spooky_incantation TYPE option<string>\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The current XOR sum of all results in this query\nDEFINE FIELD hash ON TABLE _spooky_incantation TYPE option<string>\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The Radix Tree of Result IDs for efficient sync\nDEFINE FIELD tree ON TABLE _spooky_incantation TYPE any\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- For garbage collection (Heartbeat)\nDEFINE FIELD lastActiveAt ON TABLE _spooky_incantation TYPE datetime DEFAULT time::now()\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- How long this Incantation stays alive without activity\nDEFINE FIELD ttl ON TABLE _spooky_incantation TYPE duration\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n\n-- Remote-only meta tables (not synced to client)\nDEFINE TABLE _spooky_module_state SCHEMALESS PERMISSIONS FULL;\n\n-- Unregister from DBSP on deletion\nDEFINE EVENT _spooky_dbsp_cleanup ON TABLE _spooky_incantation WHEN $event = \"DELETE\" THEN {\n    let $result = mod::dbsp::unregister_query(<string>$before.id);\n};\n\n-- Register with DBSP on creation or update\n-- Register with DBSP on creation or update\nDEFINE EVENT _spooky_dbsp_register ON TABLE _spooky_incantation WHEN $event = \"CREATE\" OR ($event = \"UPDATE\" AND ($after.surrealQL != $before.surrealQL OR $after.params != $before.params)) THEN {\n    LET $res = mod::dbsp::register_view(<string>$after.id, $after.surrealQL, <string>($after.params OR {}));\n    -- Update the incantation with the initial hash computed by DBSP\n    IF $res.result_hash != NONE THEN {\n        UPDATE _spooky_incantation SET hash = $res.result_hash, tree = $res.tree WHERE id = $after.id; \n    } END;\n};\n-- ==================================================\n-- FUNCTION: CALCULATE VIEW HASH\n-- Usage: fn::spooky::view_hash(thread:123, ['comments'])\n-- ==================================================\nDEFINE FUNCTION fn::spooky::view_hash($rid: record, $paths: array<string>) {\n    LET $shadow = (SELECT * FROM ONLY _spooky_data_hash WHERE recordId = $rid);\n    IF $shadow.recordId == NONE { RETURN crypto::blake3(\"\"); };\n\n    -- 1. Start with the Intrinsic Hash\n    LET $parts = [$shadow.intrinsicHash];\n\n    -- 2. Collect requested Composition Hashes (if they exist)\n    -- We use a subquery to map the $paths array to values safely\n    LET $extras = (\n        SELECT VALUE $shadow.compositionHash[$this] \n        FROM $paths \n        WHERE $shadow.compositionHash[$this] != NONE\n    );\n\n    -- 3. Combine and Aggregate\n    LET $all_parts = array::concat($parts, $extras);\n    \n    RETURN mod::xor::blake3_xor_multi($all_parts);\n};\n\n-- ==================================================\n-- FUNCTION: REGISTER INCANTATION (With Sorting)\n-- Usage: fn::incantation::register({ ... sort_field: 'created_at' ... })\n-- ==================================================\nDEFINE FUNCTION fn::incantation::register($config: object) {\n    -- UNPACK CONFIG\n    LET $id         = $config.id;\n    LET $client_id   = $config.client_id;\n    LET $items      = $config.items;\n    LET $paths      = $config.paths;\n    LET $table      = $config.table;\n    LET $filter     = $config.filter;\n    LET $query      = $config.query; -- Optional DBSP Plan (SQL String)\n    \n    -- Sorting Params (Default to created_at if missing)\n    LET $sort_field = $config.sort_field OR 'created_at';\n    LET $tree_init = {}; \n    \n    -- 1. CALCULATE AGGREGATE HASH\n    LET $hashes = (\n        SELECT VALUE fn::spooky::view_hash(id, $paths) \n        FROM $items\n    );\n    LET $query_hash = mod::xor::blake3_xor_multi($hashes);\n\n    -- 2. UPDATE INCANTATION REGISTRY\n    -- Use String Cast for ID to avoid type::thing issues during schema load\n    LET $rid_str = \"_spooky_incantation:\" + $id;\n    LET $rid = <record>$rid_str;\n    \n    INSERT INTO _spooky_incantation {\n        id:           $rid,\n        hash:         $query_hash,\n        clientId:     $client_id,\n        surrealQL:    $query,\n        tree:         <object>{},\n        lastActiveAt: time::now(),\n        ttl:          1h\n    };\n\n\n\n    -- 5. REGISTER WITH DBSP (If plan provided)\n    IF $query != NONE THEN {\n        LET $state = fn::dbsp::get_state();\n        LET $dbsp_res = mod::dbsp::register_query($id, $query, $state);\n        fn::dbsp::save_state($dbsp_res.new_state);\n        \n        LET $init_res = $dbsp_res.result;\n        IF $init_res != NONE THEN {\n            -- Update using the explicit ID\n            UPDATE $rid SET hash = $init_res.hash, tree = $init_res.tree;\n        } END;\n        \n        -- DEBUG: Return the entire result to inspect state\n        RETURN $dbsp_res;\n    } END;\n\n    RETURN $query_hash;\n};\n\nDEFINE FUNCTION fn::incantation::heartbeat($id: record) {\n    UPDATE $id SET lastActiveAt = time::now();\n};\n-- ==================================================\n-- AUTO-GENERATED SPOOKY EVENTS\n-- ==================================================\n\n-- Meta Table: _spooky_data_hash Mutation\n-- Automatically recalculates TotalHash when IntrinsicHash or CompositionHash changes\nDEFINE EVENT OVERWRITE _spooky_data_hash_mutation ON TABLE _spooky_data_hash\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $new_total = mod::xor::blake3_xor($after.intrinsicHash, $after.compositionHash._xor);\n    IF $new_total != $after.totalHash THEN {\n        UPDATE $after.id SET totalHash = $new_total;\n    } END;\n};\n\nDEFINE FIELD _spooky_touch ON TABLE comment TYPE any PERMISSIONS FOR select, create, update WHERE false;\n\n-- Table: comment Cascade Down (Reference Propagation)\n-- Table: comment Mutation\nDEFINE EVENT OVERWRITE _spooky_comment_mutation ON TABLE comment\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $xor_intrinsic = crypto::blake3(\"\");\n    LET $xor_composition = crypto::blake3(\"\");\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $new_composition = {};\n    LET $ref_hash_author = IF $after.author != NONE THEN (SELECT totalHash FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.author)))[0].totalHash ELSE crypto::blake3(\"\") END;\n    LET $ref_hash_author = IF $ref_hash_author != NONE THEN $ref_hash_author ELSE crypto::blake3(\"\") END;\n    LET $xor_composition = mod::xor::blake3_xor($xor_composition, $ref_hash_author);\n    LET $h_content = crypto::blake3(<string>$after.content OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_content);\n    LET $record_id = $before.id OR $after.id;\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$record_id)))[0];\n    LET $new_composition = {\n        author: $ref_hash_author,\n        _xor: $xor_composition,\n    };\n\n    LET $new_total_calculated = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $plain_after = {\n        id: <string>($after.id OR \"\"),\n        author: <string>($after.author OR \"\"),\n        content: $after.content,\n        created_at: <string>($after.created_at OR \"\"),\n        thread: <string>($after.thread OR \"\"),\n        IntrinsicHash: $new_total_calculated,\n        _hash: $new_total_calculated,\n        totalHash: $new_total_calculated,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('comment', $event, <string>($after.id OR \"\"), $plain_after);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.id));\n    UPSERT $hash_id CONTENT {\n        recordId: $after.id,\n        intrinsicHash: $xor_intrinsic,\n        compositionHash: $new_composition,\n        totalHash: NONE -- Placeholder, will be recalculated by event\n    };\n\n    LET $new_total = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $old_total = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE $new_total END;\n    LET $old_total_for_delta = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE crypto::blake3(\"\") END;\n    -- BUBBLE UP to Parent (thread)\n    IF $before.thread = $after.thread THEN {\n        LET $delta = mod::xor::blake3_xor($old_total_for_delta, $new_total_calculated);\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.thread));\n    } ELSE {\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $old_total_for_delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total_for_delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.thread)) AND id != NONE;\n\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $new_total_calculated),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $new_total_calculated)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.thread)) AND id != NONE;\n    } END;\n\n};\n\n-- Table: comment Deletion\nDEFINE EVENT OVERWRITE _spooky_comment_delete ON TABLE comment\nWHEN $event = \"DELETE\"\nTHEN {\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $plain_before = {\n        id: <string>($before.id OR \"\"),\n        author: <string>($before.author OR \"\"),\n        content: $before.content,\n        created_at: <string>($before.created_at OR \"\"),\n        thread: <string>($before.thread OR \"\"),\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('comment', \"DELETE\", <string>($before.id OR \"\"), $plain_before);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id)))[0];\n    LET $old_total = $old_hash_data.totalHash;\n\n    -- BUBBLE UP Delete to Parent\n    IF $old_total != NONE AND $before.thread != NONE THEN {\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $old_total),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.thread));\n    } END;\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id));\n    DELETE $hash_id;\n};\n\nDEFINE FIELD _spooky_touch ON TABLE thread TYPE any PERMISSIONS FOR select, create, update WHERE false;\n\n-- Table: thread Cascade Down (Reference Propagation)\nDEFINE EVENT _spooky_z_cascade_comment_thread ON TABLE thread\nWHEN $event != \"DELETE\"\nTHEN {\n    UPDATE comment SET _spooky_touch = time::now() WHERE thread = $after.id;\n};\n\n-- Table: thread Mutation\nDEFINE EVENT OVERWRITE _spooky_thread_mutation ON TABLE thread\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $xor_intrinsic = crypto::blake3(\"\");\n    LET $xor_composition = crypto::blake3(\"\");\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $new_composition = {};\n    LET $h_active = crypto::blake3(<string>$after.active OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_active);\n    LET $h_content = crypto::blake3(<string>$after.content OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_content);\n    LET $h_title = crypto::blake3(<string>$after.title OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_title);\n    LET $record_id = $before.id OR $after.id;\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$record_id)))[0];\n    LET $h_comment = IF $old_hash_data.recordId != NONE THEN $old_hash_data.compositionHash.comment ELSE crypto::blake3(\"\") END;\n    LET $xor_composition = mod::xor::blake3_xor($xor_composition, $h_comment);\n    LET $new_composition = {\n        comment: $h_comment,\n        _xor: $xor_composition,\n    };\n\n    LET $new_total_calculated = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $plain_after = {\n        id: <string>($after.id OR \"\"),\n        active: $after.active,\n        author: <string>($after.author OR \"\"),\n        content: $after.content,\n        created_at: <string>($after.created_at OR \"\"),\n        title: $after.title,\n        IntrinsicHash: $new_total_calculated,\n        _hash: $new_total_calculated,\n        totalHash: $new_total_calculated,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('thread', $event, <string>($after.id OR \"\"), $plain_after);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.id));\n    UPSERT $hash_id CONTENT {\n        recordId: $after.id,\n        intrinsicHash: $xor_intrinsic,\n        compositionHash: $new_composition,\n        totalHash: NONE -- Placeholder, will be recalculated by event\n    };\n\n    LET $new_total = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $old_total = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE $new_total END;\n    LET $old_total_for_delta = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE crypto::blake3(\"\") END;\n    -- BUBBLE UP to Parent (author)\n    IF $before.author = $after.author THEN {\n        LET $delta = mod::xor::blake3_xor($old_total_for_delta, $new_total_calculated);\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.author));\n    } ELSE {\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $old_total_for_delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total_for_delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.author)) AND id != NONE;\n\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $new_total_calculated),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $new_total_calculated)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.author)) AND id != NONE;\n    } END;\n\n};\n\n-- Table: thread Deletion\nDEFINE EVENT OVERWRITE _spooky_thread_delete ON TABLE thread\nWHEN $event = \"DELETE\"\nTHEN {\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $plain_before = {\n        id: <string>($before.id OR \"\"),\n        active: $before.active,\n        author: <string>($before.author OR \"\"),\n        content: $before.content,\n        created_at: <string>($before.created_at OR \"\"),\n        title: $before.title,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('thread', \"DELETE\", <string>($before.id OR \"\"), $plain_before);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id)))[0];\n    LET $old_total = $old_hash_data.totalHash;\n\n    -- BUBBLE UP Delete to Parent\n    IF $old_total != NONE AND $before.author != NONE THEN {\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $old_total),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.author));\n    } END;\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id));\n    DELETE $hash_id;\n};\n\nDEFINE FIELD _spooky_touch ON TABLE user TYPE any PERMISSIONS FOR select, create, update WHERE false;\n\n-- Table: user Cascade Down (Reference Propagation)\nDEFINE EVENT _spooky_z_cascade_comment_author ON TABLE user\nWHEN $event != \"DELETE\"\nTHEN {\n    UPDATE comment SET _spooky_touch = time::now() WHERE author = $after.id;\n};\n\nDEFINE EVENT _spooky_z_cascade_thread_author ON TABLE user\nWHEN $event != \"DELETE\"\nTHEN {\n    UPDATE thread SET _spooky_touch = time::now() WHERE author = $after.id;\n};\n\n-- Table: user Mutation\nDEFINE EVENT OVERWRITE _spooky_user_mutation ON TABLE user\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $xor_intrinsic = crypto::blake3(\"\");\n    LET $xor_composition = crypto::blake3(\"\");\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $new_composition = {};\n    LET $h_username = crypto::blake3(<string>$after.username OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_username);\n    LET $record_id = $before.id OR $after.id;\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$record_id)))[0];\n    LET $h_thread = IF $old_hash_data.recordId != NONE THEN $old_hash_data.compositionHash.thread ELSE crypto::blake3(\"\") END;\n    LET $xor_composition = mod::xor::blake3_xor($xor_composition, $h_thread);\n    LET $new_composition = {\n        thread: $h_thread,\n        _xor: $xor_composition,\n    };\n\n    LET $new_total_calculated = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $plain_after = {\n        id: <string>($after.id OR \"\"),\n        created_at: <string>($after.created_at OR \"\"),\n        password: $after.password,\n        username: $after.username,\n        IntrinsicHash: $new_total_calculated,\n        _hash: $new_total_calculated,\n        totalHash: $new_total_calculated,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('user', $event, <string>($after.id OR \"\"), $plain_after);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.id));\n    UPSERT $hash_id CONTENT {\n        recordId: $after.id,\n        intrinsicHash: $xor_intrinsic,\n        compositionHash: $new_composition,\n        totalHash: NONE -- Placeholder, will be recalculated by event\n    };\n\n    -- ==================================================\n    -- CASCADE DOWN (Disabled for Object Hash for now)\n    -- Logic: {} Change -> Updates Dependent INTRINSIC Hash\n    -- ==================================================\n    -- (Skipped implementation for object hash)\n\n};\n\n-- Table: user Deletion\nDEFINE EVENT OVERWRITE _spooky_user_delete ON TABLE user\nWHEN $event = \"DELETE\"\nTHEN {\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $plain_before = {\n        id: <string>($before.id OR \"\"),\n        created_at: <string>($before.created_at OR \"\"),\n        password: $before.password,\n        username: $before.username,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('user', \"DELETE\", <string>($before.id OR \"\"), $plain_before);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id)))[0];\n    LET $old_total = $old_hash_data.totalHash;\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id));\n    DELETE $hash_id;\n};\n\n" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m25361[0m
[2m2025-12-30T20:54:10.218967Z[0m [34mDEBUG[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::iam::file[0m[2m:[0m Allowed bucket folder path: /modules [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.222069Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ba862264-6655-40b8-9fc2-dfbfad367d95" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m4[0m
[2m2025-12-30T20:54:10.226165Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.226739Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.226772Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.226812Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:10.226856Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"RETURN mod::dbsp::reset({})" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m27[0m
[2m2025-12-30T20:54:10.227397Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::reset' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.175522Z[0m [35mTRACE[0m [1mupdate_node[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Updating node in the cluster [3mid[0m[2m=[0mb7f46a39-90a5-4fd3-adc4-a851d9e95efc
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.777891Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"DELETE _spooky_module_state:dbsp" [3mlength[0m[2m=[0m32[0m [2m[3minput[0m[2m=[0m"DELETE _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m32[0m
[2m2025-12-30T20:54:13.778025Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mDELETE _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.779097Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"4f09c5b3-f473-43e8-a239-28f4de4aaee8" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m3552[0m
[2m2025-12-30T20:54:13.782046Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.782099Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.782115Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.782160Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.782218Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_users_incr\", \"SELECT * FROM users_incr WHERE id = 'users_incr:active:1'\", {});\n            \n            LET $r2 = mod::dbsp::ingest(\"users_incr\", \"CREATE\", \"users_incr:active:1\", { name: \"Alice\", active: true, hash: \"0000\" });\n            RETURN $r2.updates;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m321[0m
[2m2025-12-30T20:54:13.782294Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.783387Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.783440Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.783718Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m313[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m313[0m
[2m2025-12-30T20:54:13.783783Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.784415Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "hash": String("0000"), "name": String("Alice")}
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.785099Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.785139Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_users_incr, delta_len=1, hash=2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.785623Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m643[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m643[0m
[2m2025-12-30T20:54:13.785687Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
  console.log
    DEBUG: res2: [null,null,[{"query_id":"view_users_incr","result_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","result_ids":["users_incr:active:1"],"tree":{"hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","leaves":[{"hash":"0000","id":"users_incr:active:1"}]}}]]

      at Object.<anonymous> (surrealdb/dbsp.test.ts:49:13)

[2m2025-12-30T20:54:13.786219Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7a4333d9-b168-4e59-8d1e-59636a462c65" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m4[0m
[2m2025-12-30T20:54:13.789508Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.789532Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.789548Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.789592Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.789640Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_users_active\", \"SELECT * FROM users WHERE id = 'users:active*'\", {});\n            \n            LET $r2 = mod::dbsp::register_view(\"view_threads_recent\", \"SELECT * FROM threads WHERE id = 'threads:2024*'\", {});\n            \n            LET $u_res = mod::dbsp::ingest(\"users\", \"CREATE\", \"users:active:99\", {\"name\":\"Bob\",\"active\":true,\"hash\":\"0000\"});\n            \n            LET $t_res = mod::dbsp::ingest(\"threads\", \"CREATE\", \"threads:2024:1\", {\"title\":\"Hello\",\"hash\":\"0000\"});\n            \n            RETURN {\n                user_updates: $u_res.updates,\n                thread_updates: $t_res.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m682[0m
[2m2025-12-30T20:54:13.789723Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.790543Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.790604Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.791013Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m832[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m832[0m
[2m2025-12-30T20:54:13.791078Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.791492Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.792181Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.792233Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.792521Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1025[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1025[0m
[2m2025-12-30T20:54:13.792565Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.792896Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "hash": String("0000"), "name": String("Bob")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.793374Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.793396Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_users_active, delta_len=1, hash=38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.793783Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1328[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1328[0m
[2m2025-12-30T20:54:13.793824Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.794216Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "title": String("Hello")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
[2m2025-12-30T20:54:13.794789Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.794823Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_threads_recent, delta_len=1, hash=3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.795204Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1620[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1620[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.795276Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}}]}'
[2m2025-12-30T20:54:13.795761Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7e9f605a-5c0a-4f2a-afe3-841c89085ef7" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m6[0m
[2m2025-12-30T20:54:13.799233Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.799270Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.799290Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.799331Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.799534Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"RETURN mod::dbsp::register_view(\"view_users_threads_join\", \"SELECT * FROM users, threads WHERE users.id = threads.author AND users.id = 'users:active*'\", {})" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m157[0m
[2m2025-12-30T20:54:13.799597Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.800510Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.800548Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.800911Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1924[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1924[0m
[2m2025-12-30T20:54:13.800961Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.801441Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"14fa7dc0-94db-48ce-8827-456ef5eec4a7" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m2[0m
[2m2025-12-30T20:54:13.804409Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.804429Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.804445Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.804505Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.804549Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_tree_test\", \"SELECT * FROM tree_items WHERE id = 'item*'\", {});\n            \n            LET $r2 = mod::dbsp::ingest(\"tree_items\", \"CREATE\", \"item:1\", {\"id\":\"item:1\",\"val\":\"A\",\"hash\":\"0000\"});\n            \n            LET $r3 = mod::dbsp::ingest(\"tree_items\", \"CREATE\", \"item:2\", {\"id\":\"item:2\",\"val\":\"B\",\"hash\":\"0001\"});\n            \n            LET $r4 = mod::dbsp::ingest(\"tree_items\", \"DELETE\", \"item:1\", {\"id\":\"item:1\",\"val\":\"A\",\"hash\":\"0000\"});\n            \n            RETURN $r1;\n            RETURN $r2.updates;\n            RETURN $r3.updates;\n            RETURN $r4.updates;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m646[0m
[2m2025-12-30T20:54:13.804619Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.805441Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.805525Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.806007Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2107[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2107[0m
[2m2025-12-30T20:54:13.806080Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.806541Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": String("item:1"), "val": String("A")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.807126Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.807163Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_tree_test, delta_len=1, hash=9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.807656Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"}},\"hashes\":{\"item:1\":\"fa5c3e3d21aeddc9aa4a88e6d08fff096fb794b1ba07dcb7e472eb491c953370\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:1\":1},\"last_hash\":\"9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2381[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"}},\"hashes\":{\"item:1\":\"fa5c3e3d21aeddc9aa4a88e6d08fff096fb794b1ba07dcb7e472eb491c953370\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:1\":1},\"last_hash\":\"9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2381[0m
[2m2025-12-30T20:54:13.807699Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:1":1},"rows":{"item:1":{"hash":"0000","id":"item:1","val":"A"}},"hashes":{"item:1":"fa5c3e3d21aeddc9aa4a88e6d08fff096fb794b1ba07dcb7e472eb491c953370"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:1":1},"last_hash":"9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.808158Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0001"), "id": String("item:2"), "val": String("B")}
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.808652Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.808673Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_tree_test, delta_len=1, hash=e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51, last_hash=9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.809076Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1,\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"},\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:1\":\"fa5c3e3d21aeddc9aa4a88e6d08fff096fb794b1ba07dcb7e472eb491c953370\",\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1,\"item:1\":1},\"last_hash\":\"e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2528[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1,\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"},\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:1\":\"fa5c3e3d21aeddc9aa4a88e6d08fff096fb794b1ba07dcb7e472eb491c953370\",\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1,\"item:1\":1},\"last_hash\":\"e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2528[0m
[2m2025-12-30T20:54:13.809115Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:2":1,"item:1":1},"rows":{"item:1":{"hash":"0000","id":"item:1","val":"A"},"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:1":"fa5c3e3d21aeddc9aa4a88e6d08fff096fb794b1ba07dcb7e472eb491c953370","item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1,"item:1":1},"last_hash":"e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.809600Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": String("item:1"), "val": String("A")}
[2m2025-12-30T20:54:13.810076Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.810104Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_tree_test, delta_len=1, hash=7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6, last_hash=e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.810549Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2381[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2381[0m
[2m2025-12-30T20:54:13.810597Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.811038Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"5e68b110-211d-413e-a965-295786479930" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m6[0m
  console.log
    DEBUG: Tree Test Results: [
      null,
      null,
      null,
      null,
      {
        "id": "view_tree_test",
        "msg": "Registered"
      },
      [
        {
          "query_id": "view_tree_test",
          "result_hash": "9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff",
          "result_ids": [
            "item:1"
          ],
          "tree": {
            "hash": "9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff",
            "leaves": [
              {
                "hash": "0000",
                "id": "item:1"
              }
            ]
          }
        }
      ],
      [
        {
          "query_id": "view_tree_test",
          "result_hash": "e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51",
          "result_ids": [
            "item:1",
            "item:2"
          ],
          "tree": {
            "hash": "e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51",
            "leaves": [
              {
                "hash": "0000",
                "id": "item:1"
              },
              {
                "hash": "0000",
                "id": "item:2"
              }
            ]
          }
        }
      ],
      [
        {
          "query_id": "view_tree_test",
          "result_hash": "7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6",
          "result_ids": [
            "item:2"
          ],
          "tree": {
            "hash": "7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6",
            "leaves": [
              {
                "hash": "0000",
                "id": "item:2"
              }
            ]
          }
        }
      ]
    ]

      at Object.<anonymous> (surrealdb/dbsp.test.ts:131:13)

[2m2025-12-30T20:54:13.814343Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.814360Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.814374Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.814404Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.814448Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_join_sql\", \"SELECT * FROM users, posts WHERE users.id = posts.author\", {});\n            \n            LET $u = { id: 1, name: \"Alice\", hash: \"0000\" };\n            LET $r2 = mod::dbsp::ingest(\"users\", \"CREATE\", \"users:1\", $u);\n            \n            LET $p = { id: 10, author: 1, title: \"Hello\", hash: \"0001\" };\n            LET $r3 = mod::dbsp::ingest(\"posts\", \"CREATE\", \"posts:10\", $p);\n            \n            RETURN {\n                reg: $r1.msg,\n                user_updates: $r2.updates,\n                post_updates: $r3.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m614[0m
[2m2025-12-30T20:54:13.814523Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.815039Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.815101Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.815659Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2595[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2595[0m
[2m2025-12-30T20:54:13.815708Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.816043Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(1), "name": String("Alice")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.816933Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.816991Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.817714Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2732[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2732[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.817767Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}}]}'
[2m2025-12-30T20:54:13.818128Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0001"), "id": Number(10), "title": String("Hello")}
[2m2025-12-30T20:54:13.818744Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.818774Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_join_sql, delta_len=1, hash=eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.819391Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3014[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3014[0m
[2m2025-12-30T20:54:13.819449Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.819985Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"9c5be160-a29e-478c-b615-2db2af432d84" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m5[0m
[2m2025-12-30T20:54:13.822266Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.822294Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.822309Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.822356Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.822422Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_limit_eviction\", \"SELECT * FROM users_limit LIMIT 1\", {});\n            \n            // Ingest User A (id 20)\n            LET $u1 = { id: 20, name: \"A\", hash: \"0000\" };\n            LET $r2 = mod::dbsp::ingest(\"users_limit\", \"CREATE\", \"users_limit:20\", $u1);\n            \n            // Ingest User B (id 10 - smaller, should evict A)\n            LET $u2 = { id: 10, name: \"B\", hash: \"0001\" };\n            LET $r3 = mod::dbsp::ingest(\"users_limit\", \"CREATE\", \"users_limit:10\", $u2);\n            \n            RETURN {\n                up1: $r2.updates,\n                up2: $r3.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m659[0m
[2m2025-12-30T20:54:13.822511Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.823240Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.823281Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.823826Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3182[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3182[0m
[2m2025-12-30T20:54:13.823882Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.824251Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(20), "name": String("A")}
[2m2025-12-30T20:54:13.824880Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.824924Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_limit_eviction, delta_len=1, hash=d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.825719Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:20\":1},\"last_hash\":\"d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3485[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:20\":1},\"last_hash\":\"d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3485[0m
[2m2025-12-30T20:54:13.825798Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:20":1},"last_hash":"d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.826325Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0001"), "id": Number(10), "name": String("B")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.827109Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.827157Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_limit_eviction, delta_len=2, hash=3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775, last_hash=d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.827906Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3640[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3640[0m
[2m2025-12-30T20:54:13.827979Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.828575Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"fcbc4f27-9ec7-4404-bce3-52ef4db443f1" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m6[0m
[2m2025-12-30T20:54:13.831042Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.831066Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.831085Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.831133Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.831175Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_nested_limit\", \"SELECT *, (SELECT * FROM post WHERE author=$parent.id LIMIT 2) FROM user\", {});\n            RETURN $r1;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m182[0m
[2m2025-12-30T20:54:13.831219Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.832125Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.832178Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.832918Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4021[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4021[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.833008Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}}]}'
[2m2025-12-30T20:54:13.833541Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c4b2c5f7-f7e0-4e58-bfab-ea5159d77754" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m2[0m
[2m2025-12-30T20:54:13.834944Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.834963Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.834977Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.835008Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.835051Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r_v1 = mod::dbsp::register_view(\"view_active\", \"SELECT * FROM user WHERE status = 'active'\", {});\n            LET $r_v2 = mod::dbsp::register_view(\"view_u_p\", \"SELECT * FROM user, post WHERE user.id = post.author\", {});\n            LET $r_v3 = mod::dbsp::register_view(\"view_feed\", \"SELECT * FROM post LIMIT 3\", {});\n            \n            // ... Actions (same as before) ...\n            // Action 1: Create Users\n            LET $ua = { id: 1, status: 'active', hash: \"0000\" };\n            LET $ub = { id: 2, status: 'inactive', hash: \"0000\" };\n            \n            LET $r_a1 = mod::dbsp::ingest(\"user\", \"CREATE\", \"user:1\", $ua);\n            \n            LET $r_a2 = mod::dbsp::ingest(\"user\", \"CREATE\", \"user:2\", $ub);\n            \n            // Action 2: Posts for A\n            LET $p1 = { id: 10, author: 1, hash: \"0000\" };\n            LET $r_p1 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:10\", $p1);\n            \n            LET $p2 = { id: 11, author: 1, hash: \"0000\" };\n            LET $r_p2 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:11\", $p2);\n            \n            // Action 3: Update User B -> Active\n            LET $ub_active = { id: 2, status: 'active', hash: \"0001\" };\n            LET $r_upd = mod::dbsp::ingest(\"user\", \"UPDATE\", \"user:2\", $ub_active);\n            \n            // Action 4: Posts for B\n            LET $p3 = { id: 12, author: 2, hash: \"0000\" };\n            LET $r_p3 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:12\", $p3);\n            \n            LET $p4 = { id: 13, author: 2, hash: \"0000\" };\n            LET $r_p4 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:13\", $p4);\n            \n            // Action 5: Post 0 (Smallest ID)\n            // Use padded ID to ensure \"post:05\" < \"post:10\" lexicographically\n            LET $p0 = { id: 5, author: 1, hash: \"0000\" };\n            LET $r_p0 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:05\", $p0);\n            \n            RETURN {\n                user1: $r_a1.updates,\n                user2: $r_a2.updates,\n                post1: $r_p1.updates,\n                user_upt: $r_upd.updates,\n                post4: $r_p4.updates,\n                post0: $r_p0.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2193[0m
[2m2025-12-30T20:54:13.835164Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.835797Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.835837Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.836566Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4209[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4209[0m
[2m2025-12-30T20:54:13.836637Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.837109Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.837689Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.837721Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.838341Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4416[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4416[0m
[2m2025-12-30T20:54:13.838423Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.838840Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.839591Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.839641Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.840623Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4567[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4567[0m
[2m2025-12-30T20:54:13.840696Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.841593Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(1), "status": String("active")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.842162Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.842191Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_nested_limit, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=
DEBUG: process: view=view_active, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.843083Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4904[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4904[0m
[2m2025-12-30T20:54:13.843148Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"user":{"name":"user","zset":{"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.843851Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(2), "status": String("inactive")}
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.844524Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.844580Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_nested_limit, delta_len=1, hash=4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.845472Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":1,\"user:1\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5054[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":1,\"user:1\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5054[0m
[2m2025-12-30T20:54:13.845564Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"user":{"name":"user","zset":{"user:2":1,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0000","id":2,"status":"inactive"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":1,"user:1":1},"last_hash":"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.846232Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0000"), "id": Number(10)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.846847Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.846887Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_u_p, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=
DEBUG: process: view=view_feed, delta_len=1, hash=eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.847781Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":1,\"user:1\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1},\"last_hash\":\"eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5389[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":1,\"user:1\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1},\"last_hash\":\"eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5389[0m
[2m2025-12-30T20:54:13.847852Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"user":{"name":"user","zset":{"user:2":1,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0000","id":2,"status":"inactive"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"post":{"name":"post","zset":{"post:10":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10}},"hashes":{"post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":1,"user:1":1},"last_hash":"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1},"last_hash":"eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.848428Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0000"), "id": Number(11)}
[2m2025-12-30T20:54:13.848970Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.849000Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_u_p, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
DEBUG: process: view=view_feed, delta_len=1, hash=ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f, last_hash=eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.849949Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:11\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"}},\"hashes\":{\"user:2\":\"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:11\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5535[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:11\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"}},\"hashes\":{\"user:2\":\"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:11\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5535[0m
[2m2025-12-30T20:54:13.850048Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"post":{"name":"post","zset":{"post:10":1,"post:11":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10}},"hashes":{"post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"user":{"name":"user","zset":{"user:1":1,"user:2":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0000","id":2,"status":"inactive"}},"hashes":{"user:2":"e10b02b2076ac5359256a499035d7abc90be24475249d1db9aa7d7b7d00192a9","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":1},"last_hash":"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:11":1},"last_hash":"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.851195Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0001"), "id": Number(2), "status": String("active")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.851673Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.851706Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_nested_limit, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f
DEBUG: process: view=view_active, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.852598Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:11\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5544[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:11\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5544[0m
[2m2025-12-30T20:54:13.852667Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"post":{"name":"post","zset":{"post:10":1,"post:11":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11}},"hashes":{"post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:11":1},"last_hash":"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.853313Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"author": Number(2), "hash": String("0000"), "id": Number(12)}
[2m2025-12-30T20:54:13.854013Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.854053Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_u_p, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
DEBUG: process: view=view_feed, delta_len=1, hash=7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec, last_hash=ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.855000Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:10\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:12\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5701[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:10\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:12\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5701[0m
[2m2025-12-30T20:54:13.855102Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"post":{"name":"post","zset":{"post:12":1,"post:10":1,"post:11":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12},"post:11":{"author":1,"hash":"0000","id":11}},"hashes":{"post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:12":1,"post:11":1,"post:10":1},"last_hash":"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.855936Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"author": Number(2), "hash": String("0000"), "id": Number(13)}
[2m2025-12-30T20:54:13.856540Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.856579Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_u_p, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.857520Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:12\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5835[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:12\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5835[0m
[2m2025-12-30T20:54:13.857600Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"post":{"name":"post","zset":{"post:10":1,"post:12":1,"post:13":1,"post:11":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11},"post:13":{"author":2,"hash":"0000","id":13}},"hashes":{"post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:12":1,"post:11":1,"post:10":1},"last_hash":"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.858025Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0000"), "id": Number(5)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.858557Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.858590Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_u_p, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78
DEBUG: process: view=view_feed, delta_len=2, hash=7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033, last_hash=7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.859478Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:11\":1,\"post:12\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5968[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:11\":1,\"post:12\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5968[0m
[2m2025-12-30T20:54:13.859566Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"post":{"name":"post","zset":{"post:05":1,"post:11":1,"post:12":1,"post:13":1,"post:10":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10}},"hashes":{"post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:05":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.860244Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cb24d30a-b1f6-48e8-a145-0d45ffc7d8e7" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m25[0m
[2m2025-12-30T20:54:13.862593Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.862612Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.862638Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.862690Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.862736Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_order\", \"SELECT * FROM items ORDER BY val DESC LIMIT 2\", {});\n            LET $r2 = mod::dbsp::register_view(\"view_or\", \"SELECT * FROM items WHERE val = 10 OR val = 100\", {});\n            \n            // Ingest\n            LET $i1 = { id: 1, val: 10, hash: \"0000\" };\n            LET $i2 = { id: 2, val: 20, hash: \"0000\" };\n            LET $i3 = { id: 3, val: 100, hash: \"0000\" };\n            \n            LET $res1 = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:1\", $i1);\n            LET $res2 = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:2\", $i2);\n            LET $res3 = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:3\", $i3);\n            \n            RETURN {\n                up1: $res1.updates,\n                up2: $res2.updates,\n                up3: $res3.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m845[0m
[2m2025-12-30T20:54:13.862833Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.863584Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.863647Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.864457Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:11\":1,\"post:05\":1,\"post:13\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:05\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6153[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:11\":1,\"post:05\":1,\"post:13\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:05\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6153[0m
[2m2025-12-30T20:54:13.864551Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"post":{"name":"post","zset":{"post:10":1,"post:12":1,"post:11":1,"post:05":1,"post:13":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13},"post:05":{"author":1,"hash":"0000","id":5},"post:12":{"author":2,"hash":"0000","id":12}},"hashes":{"post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1,"post:05":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.864982Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.865701Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.865754Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.866742Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:05\":1,\"post:10\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6398[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:05\":1,\"post:10\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6398[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.866848Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"post":{"name":"post","zset":{"post:12":1,"post:05":1,"post:10":1,"post:13":1,"post:11":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:13":{"author":2,"hash":"0000","id":13},"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12}},"hashes":{"post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{},"last_hash":"","params":{}}]}'
[2m2025-12-30T20:54:13.867345Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(1), "val": Number(10)}
[2m2025-12-30T20:54:13.867940Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.867971Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=1, hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa, last_hash=
DEBUG: process: view=view_or, delta_len=1, hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.869013Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}},\"hashes\":{\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:05\":1,\"post:11\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6733[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}},\"hashes\":{\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:05\":1,\"post:11\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6733[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.869096Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"items":{"name":"items","zset":{"items:1":1},"rows":{"items:1":{"hash":"0000","id":1,"val":10}},"hashes":{"items:1":"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"post":{"name":"post","zset":{"post:12":1,"post:05":1,"post:11":1,"post:13":1,"post:10":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:13":{"author":2,"hash":"0000","id":13},"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10}},"hashes":{"post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:10":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:1":1},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}}]}'
[2m2025-12-30T20:54:13.869721Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(2), "val": Number(20)}
[2m2025-12-30T20:54:13.870238Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.870266Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=1, hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a, last_hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.871337Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:1\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}},\"hashes\":{\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\",\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:13\":1,\"post:05\":1,\"post:10\":1,\"post:12\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":1,\"items:2\":1},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6876[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:1\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}},\"hashes\":{\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\",\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:13\":1,\"post:05\":1,\"post:10\":1,\"post:12\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":1,\"items:2\":1},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6876[0m
[2m2025-12-30T20:54:13.871419Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"items":{"name":"items","zset":{"items:2":1,"items:1":1},"rows":{"items:1":{"hash":"0000","id":1,"val":10},"items:2":{"hash":"0000","id":2,"val":20}},"hashes":{"items:1":"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9","items:2":"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"post":{"name":"post","zset":{"post:11":1,"post:13":1,"post:05":1,"post:10":1,"post:12":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11},"post:13":{"author":2,"hash":"0000","id":13}},"hashes":{"post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:10":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:1":1,"items:2":1},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.872223Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(3), "val": Number(100)}
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.872853Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.872905Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=2, hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f, last_hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a
DEBUG: process: view=view_or, delta_len=1, hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd, last_hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.874177Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:12\":1,\"post:11\":1,\"post:05\":1,\"post:10\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:3\":1,\"items:2\":1,\"items:1\":1},\"rows\":{\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}},\"hashes\":{\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\",\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1,\"items:3\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7020[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:12\":1,\"post:11\":1,\"post:05\":1,\"post:10\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:3\":1,\"items:2\":1,\"items:1\":1},\"rows\":{\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}},\"hashes\":{\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\",\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1,\"items:3\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7020[0m
[2m2025-12-30T20:54:13.874278Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"post":{"name":"post","zset":{"post:13":1,"post:12":1,"post:11":1,"post:05":1,"post:10":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:13":{"author":2,"hash":"0000","id":13},"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11}},"hashes":{"post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947"}},"items":{"name":"items","zset":{"items:3":1,"items:2":1,"items:1":1},"rows":{"items:3":{"hash":"0000","id":3,"val":100},"items:2":{"hash":"0000","id":2,"val":20},"items:1":{"hash":"0000","id":1,"val":10}},"hashes":{"items:3":"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7","items:1":"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9","items:2":"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:05":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":1,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1,"items:3":1},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.875229Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"645f9a4c-772c-47a1-8f9e-6ee105061ea4" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m12[0m
[2m2025-12-30T20:54:13.877857Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.877875Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.877890Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.877932Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.877976Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"complex_filter\", \"SELECT * FROM items WHERE (category = 'A' OR category = 'B') AND active = true\", {});\n            LET $r2 = mod::dbsp::register_view(\"multi_order\", \"SELECT * FROM items ORDER BY category ASC, score DESC LIMIT 2\", {});\n            \n            LET $i1 = { category: 'A', score: 10, active: true, hash: \"0000\" };\n            LET $i2 = { category: 'A', score: 20, active: false, hash: \"0000\" };\n            LET $i3 = { category: 'B', score: 10, active: true, hash: \"0000\" };\n            LET $i4 = { category: 'A', score: 30, active: true, hash: \"0000\" };\n            \n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:1\", $i1);\n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:2\", $i2);\n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:3\", $i3);\n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:4\", $i4);\n            \n            RETURN $res.updates;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m994[0m
[2m2025-12-30T20:54:13.878052Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.878674Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.878715Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.879614Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:12\":1,\"post:05\":1,\"post:11\":1,\"post:10\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:3\":1,\"items:2\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100}},\"hashes\":{\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1,\"items:3\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7208[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:12\":1,\"post:05\":1,\"post:11\":1,\"post:10\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}},\"hashes\":{\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:3\":1,\"items:2\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100}},\"hashes\":{\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1,\"items:3\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7208[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.879714Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"post":{"name":"post","zset":{"post:13":1,"post:12":1,"post:05":1,"post:11":1,"post:10":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11}},"hashes":{"post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}},"items":{"name":"items","zset":{"items:1":1,"items:3":1,"items:2":1},"rows":{"items:2":{"hash":"0000","id":2,"val":20},"items:1":{"hash":"0000","id":1,"val":10},"items:3":{"hash":"0000","id":3,"val":100}},"hashes":{"items:2":"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9","items:3":"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7","items:1":"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":1,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1,"items:3":1},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{},"last_hash":"","params":{}}]}'
[2m2025-12-30T20:54:13.880413Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.881150Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.881215Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.882186Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:3\":1,\"items:2\":1},\"rows\":{\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}},\"hashes\":{\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:10\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}},\"hashes\":{\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1,\"items:1\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7435[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:3\":1,\"items:2\":1},\"rows\":{\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}},\"hashes\":{\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:1\":\"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:10\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}},\"hashes\":{\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1,\"items:1\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7435[0m
[2m2025-12-30T20:54:13.882274Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"items":{"name":"items","zset":{"items:1":1,"items:3":1,"items:2":1},"rows":{"items:3":{"hash":"0000","id":3,"val":100},"items:2":{"hash":"0000","id":2,"val":20},"items:1":{"hash":"0000","id":1,"val":10}},"hashes":{"items:2":"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9","items:3":"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7","items:1":"16c7c2651ba972fc016d270dee9c0b09b05aaaac1da586f247c3d98f604f14c9"}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"post":{"name":"post","zset":{"post:05":1,"post:10":1,"post:12":1,"post:13":1,"post:11":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13},"post:12":{"author":2,"hash":"0000","id":12}},"hashes":{"post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:10":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":1,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1,"items:1":1},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.882886Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "category": String("A"), "hash": String("0000"), "score": Number(10)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.883447Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.883487Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_or, delta_len=1, hash=4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d, last_hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd
DEBUG: process: view=complex_filter, delta_len=1, hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa, last_hash=
DEBUG: process: view=multi_order, delta_len=2, hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.884887Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":2,\"items:2\":1,\"items:3\":1},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}},\"hashes\":{\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\",\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:11\":1,\"post:10\":1,\"post:12\":1,\"post:05\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7609[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":2,\"items:2\":1,\"items:3\":1},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}},\"hashes\":{\"items:2\":\"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9\",\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:11\":1,\"post:10\":1,\"post:12\":1,\"post:05\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}},\"hashes\":{\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7609[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.884961Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"items":{"name":"items","zset":{"items:1":2,"items:2":1,"items:3":1},"rows":{"items:1":{"active":true,"category":"A","hash":"0000","score":10},"items:3":{"hash":"0000","id":3,"val":100},"items:2":{"hash":"0000","id":2,"val":20}},"hashes":{"items:2":"d005b95224556b9b5e5dada92beb41eb89b86f6a9bd409aaa80de652cdb9dbb9","items:1":"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e","items:3":"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7"}},"post":{"name":"post","zset":{"post:13":1,"post:11":1,"post:10":1,"post:12":1,"post:05":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13},"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10}},"hashes":{"post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":1,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1},"last_hash":"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:1":2},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:2":1,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}}]}'
[2m2025-12-30T20:54:13.885896Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(false), "category": String("A"), "hash": String("0000"), "score": Number(20)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.886637Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.886665Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=2, hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd, last_hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f
DEBUG: process: view=multi_order, delta_len=1, hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f, last_hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.887986Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:13\":1,\"post:12\":1,\"post:05\":1,\"post:11\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":2,\"items:2\":2,\"items:3\":1},\"rows\":{\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100}},\"hashes\":{\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:2\":\"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:1\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7634[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:13\":1,\"post:12\":1,\"post:05\":1,\"post:11\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":2,\"items:2\":2,\"items:3\":1},\"rows\":{\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100}},\"hashes\":{\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\",\"items:3\":\"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7\",\"items:2\":\"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}},\"hashes\":{\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\",\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:1\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7634[0m
[2m2025-12-30T20:54:13.888060Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"post":{"name":"post","zset":{"post:10":1,"post:13":1,"post:12":1,"post:05":1,"post:11":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13}},"hashes":{"post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"items":{"name":"items","zset":{"items:1":2,"items:2":2,"items:3":1},"rows":{"items:2":{"active":false,"category":"A","hash":"0000","score":20},"items:1":{"active":true,"category":"A","hash":"0000","score":10},"items:3":{"hash":"0000","id":3,"val":100}},"hashes":{"items:1":"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e","items:3":"7e2e048e2b8fc485baaea547ebac6e9e6c71b882fbd3dbe2b646dd441dd0e7f7","items:2":"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}},"hashes":{"users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19","users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:3":1,"items:1":2},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1},"last_hash":"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:1":2},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:2":2,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.888723Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "category": String("B"), "hash": String("0000"), "score": Number(10)}
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.889415Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.889442Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=2, hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a, last_hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd
DEBUG: process: view=view_or, delta_len=1, hash=af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262, last_hash=4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d
DEBUG: process: view=complex_filter, delta_len=1, hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd, last_hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa
DEBUG: process: view=multi_order, delta_len=2, hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a, last_hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.891478Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:3\":2,\"items:1\":2,\"items:2\":2},\"rows\":{\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10}},\"hashes\":{\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\",\"items:2\":\"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923\",\"items:3\":\"d60e701a7ff2aa3645dfcb136db581283c0c8701d6c9cba1f53a6e94c8971906\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:13\":1,\"post:12\":1,\"post:10\":1,\"post:05\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:05\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:3\":2,\"items:1\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":2,\"items:2\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7658[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:3\":2,\"items:1\":2,\"items:2\":2},\"rows\":{\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10}},\"hashes\":{\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\",\"items:2\":\"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923\",\"items:3\":\"d60e701a7ff2aa3645dfcb136db581283c0c8701d6c9cba1f53a6e94c8971906\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:13\":1,\"post:12\":1,\"post:10\":1,\"post:05\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\",\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}},\"hashes\":{\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\",\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}},\"hashes\":{\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\",\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:05\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:3\":2,\"items:1\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":2,\"items:2\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7658[0m
[2m2025-12-30T20:54:13.891602Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"items":{"name":"items","zset":{"items:3":2,"items:1":2,"items:2":2},"rows":{"items:3":{"active":true,"category":"B","hash":"0000","score":10},"items:2":{"active":false,"category":"A","hash":"0000","score":20},"items:1":{"active":true,"category":"A","hash":"0000","score":10}},"hashes":{"items:1":"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e","items:2":"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923","items:3":"d60e701a7ff2aa3645dfcb136db581283c0c8701d6c9cba1f53a6e94c8971906"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"post":{"name":"post","zset":{"post:11":1,"post:13":1,"post:12":1,"post:10":1,"post:05":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13}},"hashes":{"post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6","post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}},"hashes":{"users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8","users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}},"hashes":{"user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe","user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1,"post:05":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":2,"items:1":2},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{},"last_hash":"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:3":2,"items:1":2},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:1":2,"items:2":2},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.893151Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "category": String("A"), "hash": String("0000"), "score": Number(30)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.893817Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:54:13.893864Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=complex_filter, delta_len=1, hash=8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc, last_hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd
DEBUG: process: view=multi_order, delta_len=2, hash=7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91, last_hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:54:13.895348Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:11\":1,\"post:05\":1,\"post:12\":1,\"post:10\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":2,\"items:3\":2,\"items:2\":2,\"items:4\":1},\"rows\":{\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:4\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":30},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10}},\"hashes\":{\"items:3\":\"d60e701a7ff2aa3645dfcb136db581283c0c8701d6c9cba1f53a6e94c8971906\",\"items:4\":\"a5d4af4a98e53237fcb58146dad76d03ac24c67d97b7f62efb6bc5e616bfc606\",\"items:2\":\"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923\",\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:3\":2,\"items:4\":1,\"items:1\":2},\"last_hash\":\"8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:4\":1,\"items:2\":2},\"last_hash\":\"7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m7825[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:11\":1,\"post:05\":1,\"post:12\":1,\"post:10\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}},\"hashes\":{\"post:11\":\"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947\",\"post:10\":\"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c\",\"post:05\":\"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c\",\"post:12\":\"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617\",\"post:13\":\"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6\"}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}},\"hashes\":{\"threads:2024:1\":\"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c\"}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}},\"hashes\":{\"users:active:99\":\"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c\",\"users:1\":\"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8\"}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}},\"hashes\":{\"item:2\":\"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd\"}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}},\"hashes\":{\"users_incr:active:1\":\"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688\"}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}},\"hashes\":{\"posts:10\":\"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c\"}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}},\"hashes\":{\"user:1\":\"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e\",\"user:2\":\"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe\"}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}},\"hashes\":{\"users_limit:10\":\"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c\",\"users_limit:20\":\"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19\"}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":2,\"items:3\":2,\"items:2\":2,\"items:4\":1},\"rows\":{\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:4\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":30},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10}},\"hashes\":{\"items:3\":\"d60e701a7ff2aa3645dfcb136db581283c0c8701d6c9cba1f53a6e94c8971906\",\"items:4\":\"a5d4af4a98e53237fcb58146dad76d03ac24c67d97b7f62efb6bc5e616bfc606\",\"items:2\":\"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923\",\"items:1\":\"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e\"}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:3\":2,\"items:4\":1,\"items:1\":2},\"last_hash\":\"8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:4\":1,\"items:2\":2},\"last_hash\":\"7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m7825[0m
[2m2025-12-30T20:54:13.895420Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"post":{"name":"post","zset":{"post:13":1,"post:11":1,"post:05":1,"post:12":1,"post:10":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13}},"hashes":{"post:11":"6765a9bd3c5eb584323383f3d4703dbf5f6f6a7eb6e2359a0827c9fb30e26947","post:10":"ec77d59e42a164df787c7720d8e4e2d7578389da1739e817c7a002e2e14b6e5c","post:05":"08a1a8c90eea770211738be05366bfc0e924f1eb9b4b63212396d67da825284c","post:12":"b4fb31af681b4a8870befe23f06b393076d7b6852e89e1bd69bafbfa15dfa617","post:13":"5830526d77a8647c385eb6d29c9eeee7f5e469b47ae127ff2329c246155390c6"}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}},"hashes":{"threads:2024:1":"52e53de5f847dd79fba656d89d0e7384829bbf87cceeb5e3631d6ebc14797d8c"}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}},"hashes":{"users:active:99":"56be21a2a3b86afe9894f7bd66729cba63d116d7cfaacaa5a9fc9f507c7f996c","users:1":"9001af1e4c1a614584aa4809f8f098d529f4522f1f896b9c2a3ab4903e9f4cb8"}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}},"hashes":{"item:2":"48de3c082916e72ec3d0acdef20a891fee06c134da5b19451944b8880bd744fd"}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}},"hashes":{"users_incr:active:1":"64d50460054a813a10a42506872db9b03076c278d57d8b13f816cdaa44dff688"}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}},"hashes":{"posts:10":"ce44a803ba4068cf271c3eb69423dfd5f826354081341c1df39f4037d944ef7c"}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}},"hashes":{"user:1":"a5ec562e5b3d44ff2bbb16380c284cd62966b383ac3916179211115f2cbe2a1e","user:2":"2425098f0b056cc0c6e7e6be6020c8988a0fb48ad0a5d8e8709f896e5289befe"}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}},"hashes":{"users_limit:10":"9ab560e82d80a06e4822f850ac5f6ffa6d46591ec3cc156cd20b1110fa99e90c","users_limit:20":"61f26834886ec3da78c20f41158328c6d6b7b47ca4fbea92f4755ba1d5befb19"}},"items":{"name":"items","zset":{"items:1":2,"items:3":2,"items:2":2,"items:4":1},"rows":{"items:3":{"active":true,"category":"B","hash":"0000","score":10},"items:2":{"active":false,"category":"A","hash":"0000","score":20},"items:4":{"active":true,"category":"A","hash":"0000","score":30},"items:1":{"active":true,"category":"A","hash":"0000","score":10}},"hashes":{"items:3":"d60e701a7ff2aa3645dfcb136db581283c0c8701d6c9cba1f53a6e94c8971906","items:4":"a5d4af4a98e53237fcb58146dad76d03ac24c67d97b7f62efb6bc5e616bfc606","items:2":"eff954cb3f74b996c77a19579548ae2a17710dd16cd1ee8cdc37435d36b86923","items:1":"45c0d203289e87fda54d61c20db97669ad31b13fa0be87559e661d2f8865123e"}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:10":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":2,"items:1":2},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{},"last_hash":"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:3":2,"items:4":1,"items:1":2},"last_hash":"8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:4":1,"items:2":2},"last_hash":"7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:54:13.896307Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"f8e15e9e-8f65-4528-b904-835fd5f5155f" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m18[0m
[2m2025-12-30T20:54:13.898525Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"e0e3d215-28a2-42a2-9c37-faa9694de2c5" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.898549Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"e0e3d215-28a2-42a2-9c37-faa9694de2c5" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.898567Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"e0e3d215-28a2-42a2-9c37-faa9694de2c5" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.898612Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"e0e3d215-28a2-42a2-9c37-faa9694de2c5" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:54:13.898974Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"e0e3d215-28a2-42a2-9c37-faa9694de2c5" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"REMOVE DATABASE test_db;" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m24[0m
PASS surrealdb/dbsp.test.ts (5.224 s)
  DBSP Module Integration
    ‚úì should register a view and ingest data with incremental updates (8 ms)
    ‚úì should support multiple concurrent views (9 ms)
    ‚úì should register a complex join plan (SQL) (6 ms)
    ‚úì should update id tree on data change (10 ms)
    ‚úì should support complex recursive join with subquery via SQL (8 ms)
    ‚úì should handle limit eviction (9 ms)
    ‚úì should handle nested limit via subquery projection (SQL) (4 ms)
    ‚úì Full Scenario: Social Network End-to-End (27 ms)
    ‚úì should handle ORDER BY and OR logic (15 ms)
    ‚úì should handle complex AND/OR and multi-field ORDER BY (20 ms)

Test Suites: 1 passed, 1 total
Tests:       10 passed, 10 total
Snapshots:   0 total
Time:        5.362 s
Ran all test suites matching /surrealdb\/dbsp.test.ts/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
