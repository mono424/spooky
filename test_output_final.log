
> @spooky/tests@0.0.0 test /Users/khadim/dev/spooky/tests
> jest --runInBand surrealdb/dbsp.test.ts

  console.log
    Starting SurrealDB container...

      at getContainer (surrealdb/setup.ts:17:11)


 .d8888b.                                             888 8888888b.  888888b.
d88P  Y88b                                            888 888  'Y88b 888  '88b
Y88b.                                                 888 888    888 888  .88P
 'Y888b.   888  888 888d888 888d888  .d88b.   8888b.  888 888    888 8888888K.
    'Y88b. 888  888 888P'   888P'   d8P  Y8b     '88b 888 888    888 888  'Y88b
      '888 888  888 888     888     88888888 .d888888 888 888    888 888    888
Y88b  d88P Y88b 888 888     888     Y8b.     888  888 888 888  .d88P 888   d88P
 'Y8888P'   'Y88888 888     888      'Y8888  'Y888888 888 8888888P'  8888888P'


[2m2025-12-30T20:26:53.462068Z[0m [32m INFO[0m [2msurrealdb_server::env[0m[2m:[0m Running 3.0.0-alpha.17 for linux on aarch64
[2m2025-12-30T20:26:53.487138Z[0m [34mDEBUG[0m [1minit[0m: [2msurrealdb_server::dbs[0m[2m:[0m Server capabilities: scripting=true, guest_access=true, live_query_notifications=true, allow_funcs=all, deny_funcs=none, allow_net=all, deny_net=none, allow_rpc=all, deny_rpc=none, allow_http=all, deny_http=none, allow_experimental=all, deny_experimental=none, allow_arbitrary_query=all, deny_arbitrary_query=none
[2m2025-12-30T20:26:53.487166Z[0m [32m INFO[0m [1minit[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Starting kvs store in memory
[2m2025-12-30T20:26:53.488022Z[0m [32m INFO[0m [1minit[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Started kvs store in memory
[2m2025-12-30T20:26:53.505167Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"check_version" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:26:53.505180Z[0m [32m INFO[0m [1minit[0m:[1minitialise_defaults[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m This is a new SurrealDB instance. Initialising default namespace 'main' and database 'main'
[2m2025-12-30T20:26:53.505195Z[0m [35mTRACE[0m [1minit[0m:[1minitialise_defaults[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3minput[0m[2m=[0m"\n\t\t\tDEFINE NAMESPACE $namespace COMMENT 'Default namespace generated by SurrealDB'; \n\t\t\tUSE NS $namespace;\n\t\t\tDEFINE DATABASE $database COMMENT 'Default database generated by SurrealDB'; \n\t\t\tDEFINE CONFIG DEFAULT NAMESPACE $namespace DATABASE $database;\n\t\t" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m256[0m
[2m2025-12-30T20:26:53.505511Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"initialise_defaults" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:26:53.505517Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Initialising credentials [3muser[0m[2m=[0mroot
[2m2025-12-30T20:26:53.505531Z[0m [32m INFO[0m [1minit[0m:[1minitialise_credentials[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Credentials were provided, and no root users were found. The root user 'root' will be created
[2m2025-12-30T20:26:53.519016Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"initialise_credentials" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:26:53.519041Z[0m [35mTRACE[0m [1minit[0m:[1minsert_node[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Inserting node in the cluster [3mid[0m[2m=[0m39ff6b30-798a-4638-b4c0-6a90f82dca66
[2m2025-12-30T20:26:53.530019Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"Insert node" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:26:53.530030Z[0m [35mTRACE[0m [1minit[0m:[1mexpire_nodes[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Archiving expired nodes in the cluster
[2m2025-12-30T20:26:53.530058Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"Expire nodes" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:26:53.530064Z[0m [35mTRACE[0m [1minit[0m:[1mremove_nodes[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Cleaning up archived nodes in the cluster
[2m2025-12-30T20:26:53.530078Z[0m [32m INFO[0m [1minit[0m: [2msurreal::dbs[0m[2m:[0m Operation succeeded [3moperation[0m[2m=[0m"Remove nodes" [3mattempts[0m[2m=[0m1
[2m2025-12-30T20:26:53.530115Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Updating node registration information every 3s
[2m2025-12-30T20:26:53.530134Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Processing and cleaning archived nodes every 300s
[2m2025-12-30T20:26:53.530138Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Running changefeed garbage collection every 30s
[2m2025-12-30T20:26:53.530136Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Processing and archiving inactive nodes every 15s
[2m2025-12-30T20:26:53.530140Z[0m [35mTRACE[0m [2msurrealdb::engine::tasks[0m[2m:[0m Running index compaction every 5s
[2m2025-12-30T20:26:53.530170Z[0m [33m WARN[0m [2msurrealdb_server::ntw[0m[2m:[0m ‚ùåüîíIMPORTANT: GraphQL is a pre-release feature with known security flaws. This is not recommended for production use.üîí‚ùå
[2m2025-12-30T20:26:53.530237Z[0m [32m INFO[0m [2msurrealdb::net[0m[2m:[0m Started web server on 0.0.0.0:8000
[2m2025-12-30T20:26:53.530244Z[0m [32m INFO[0m [2msurrealdb::net[0m[2m:[0m Listening for a system shutdown signal.
  console.log
    SurrealDB started on port 56427

      at getContainer (surrealdb/setup.ts:62:11)

[2m2025-12-30T20:26:53.548893Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"21" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ef0c1657-a25a-47dd-bb79-ad3eabd40682" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.549340Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"21" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ef0c1657-a25a-47dd-bb79-ad3eabd40682" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m0[0m
[2m2025-12-30T20:26:53.557658Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"59" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"758d7dde-e245-44cf-8902-2831661606ad" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.573263Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::signin[0m[2m:[0m Signing in as root [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"59" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"758d7dde-e245-44cf-8902-2831661606ad" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.573331Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"59" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"758d7dde-e245-44cf-8902-2831661606ad" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m15[0m
[2m2025-12-30T20:26:53.575897Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"723af192-ec77-433f-b723-036ee6042aff" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.575924Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"723af192-ec77-433f-b723-036ee6042aff" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.575945Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"723af192-ec77-433f-b723-036ee6042aff" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.576036Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"723af192-ec77-433f-b723-036ee6042aff" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.576085Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"723af192-ec77-433f-b723-036ee6042aff" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"REMOVE DATABASE test_db;" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m24[0m
[2m2025-12-30T20:26:53.576170Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"723af192-ec77-433f-b723-036ee6042aff" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m0[0m
[2m2025-12-30T20:26:53.577754Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7244afc5-1d20-4f0d-b737-a769ec31f8e6" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.577765Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7244afc5-1d20-4f0d-b737-a769ec31f8e6" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.577776Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7244afc5-1d20-4f0d-b737-a769ec31f8e6" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.577798Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7244afc5-1d20-4f0d-b737-a769ec31f8e6" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.577823Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7244afc5-1d20-4f0d-b737-a769ec31f8e6" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"DEFINE DATABASE test_db;" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m24[0m
[2m2025-12-30T20:26:53.578039Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"70" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7244afc5-1d20-4f0d-b737-a769ec31f8e6" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m0[0m
  console.log
    Loading generated schema from: /Users/khadim/dev/spooky/tests/.spooky/schema.gen.surql

      at createTestDb (surrealdb/setup.ts:100:13)

[2m2025-12-30T20:26:53.581154Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.581170Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.581184Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.581213Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.581318Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"-- This file is auto-generated. Do not edit manually.\n-- Generated by syncgen - any changes will be overwritten.\n\n\n-- ==================================================\n-- SURREALISM MODULES\n-- ==================================================\n\n-- Define bucket for module files\nDEFINE BUCKET IF NOT EXISTS modules BACKEND \"file:///modules\";\n\n-- Define the XOR module\nDEFINE MODULE mod::xor AS f\"modules:/xor_module.surli\";\n\n-- Define the DBSP module\nDEFINE MODULE mod::dbsp AS f\"modules:/dbsp_module.surli\";\n\n-- ##################################################################\n-- SCOPES & AUTHENTICATION\n-- ##################################################################\nDEFINE ACCESS account ON DATABASE TYPE RECORD\nSIGNUP {\n  IF string::len($username) <= 3 { THROW \"Username must be longer than 3 characters\" };\n  IF string::len($password) == 0 { THROW \"Password cannot be empty\" };\n\n  LET $existing = (SELECT value id FROM user WHERE username = $username LIMIT 1)[0];\n  IF $existing != NONE { THROW \"Username '\" + <string>$username + \"' is already taken\" };\n\n  LET $u = CREATE user SET username = $username, password = crypto::argon2::generate($password);\n  RETURN $u;\n}\nSIGNIN ( SELECT * FROM user WHERE username = $username AND crypto::argon2::compare(password, $password) )\nDURATION FOR TOKEN 365d, FOR SESSION 365d\n;\n\nDEFINE FUNCTION fn::polyfill::createAccount($username: string, $password: string) {\n  IF string::len($username) <= 3 { THROW \"Username must be longer than 3 characters\" };\n  IF string::len($password) == 0 { THROW \"Password cannot be empty\" };\n\n  LET $existing = (SELECT value id FROM user WHERE username = $username LIMIT 1)[0];\n  IF $existing != NONE { THROW \"Username '\" + <string>$username + \"' is already taken\" };\n\n  LET $u = CREATE user SET username = $username, password = crypto::argon2::generate($password);\n  RETURN $u;\n};\n\n-- ##################################################################\n-- USER TABLE\n-- ##################################################################\n\nDEFINE TABLE user SCHEMAFULL\nPERMISSIONS\n  FOR update, delete WHERE $access = \"account\" AND id = $auth.id\n  FOR create, select WHERE true;\n\nDEFINE FIELD username ON TABLE user TYPE string\nASSERT $value != NONE AND string::len($value) > 3\nPERMISSIONS\n    FOR select WHERE true\n    FOR create WHERE true\n    FOR update WHERE $access = \"account\" AND id = $auth.id;\n    \nDEFINE INDEX unique_username ON TABLE user FIELDS username UNIQUE;\n\nDEFINE FIELD password ON TABLE user TYPE string\nASSERT $value != NONE AND string::len($value) > 0\nPERMISSIONS\n    FOR select WHERE false\n    FOR create WHERE true\n    FOR update WHERE $access = \"account\" AND id = $auth.id;\n\nDEFINE FIELD created_at ON TABLE user TYPE datetime\nVALUE time::now()\nPERMISSIONS\n    FOR select WHERE false\n    FOR create WHERE true\n    FOR update WHERE $access = \"account\" AND id = $auth.id;\n\n-- ##################################################################\n-- THREAD TABLE\n-- ##################################################################\n\nDEFINE TABLE thread SCHEMAFULL\n  PERMISSIONS\n    FOR select WHERE true\n    FOR update, delete, create WHERE $access = \"account\" AND author.id = $auth.id\n;\n\n\nDEFINE FIELD title ON TABLE thread TYPE string\n    ASSERT $value != NONE AND string::len($value) > 0 AND string::len($value) <= 200;\n\nDEFINE FIELD content ON TABLE thread TYPE string\n    ASSERT $value != NONE AND string::len($value) > 0;\n\nDEFINE FIELD author ON TABLE thread TYPE record<user>; -- @parent\n\nDEFINE FIELD created_at ON TABLE thread TYPE datetime\n    VALUE time::now();\n\nDEFINE FIELD active ON TABLE thread TYPE bool VALUE $value OR false;\n\n-- ##################################################################\n-- COMMENT TABLE\n-- ##################################################################\n\nDEFINE TABLE comment SCHEMAFULL\n  PERMISSIONS\n    FOR select WHERE true\n    FOR update, delete, create WHERE $access = \"account\" AND author.id = $auth.id\n;\n\nDEFINE FIELD thread ON TABLE comment TYPE record<thread>; -- @parent\n\nDEFINE FIELD content ON TABLE comment TYPE string\n    ASSERT $value != NONE AND string::len($value) > 0;\n\nDEFINE FIELD author ON TABLE comment TYPE record<user>;\n\nDEFINE FIELD created_at ON TABLE comment TYPE datetime\n    VALUE time::now();\n\n-- ##################################################################\n-- RELATION TABLES\n-- ##################################################################\n\nDEFINE TABLE commented_on SCHEMAFULL TYPE RELATION\n  FROM comment TO thread\n  PERMISSIONS FOR select WHERE true;\n\nDEFINE EVENT comment_created ON TABLE comment WHEN $event = \"CREATE\" THEN\n  RELATE ($after.id)->commented_on->($after.thread)\n;\n-- ==================================================\n-- SPOOKY INCANTATION\n-- The Registry of active Live Queries (Incantations).\n-- ==================================================\n\nDEFINE TABLE _spooky_incantation SCHEMALESS\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The raw query string (for re-hydration/debugging)\n-- The raw query string (for re-hydration/debugging)\nDEFINE FIELD surrealQL ON TABLE _spooky_incantation TYPE option<string>\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The raw query string (for re-hydration/debugging)\nDEFINE FIELD clientId ON TABLE _spooky_incantation TYPE option<string>\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The current XOR sum of all results in this query\nDEFINE FIELD hash ON TABLE _spooky_incantation TYPE option<string>\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- The Radix Tree of Result IDs for efficient sync\nDEFINE FIELD tree ON TABLE _spooky_incantation TYPE any\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- For garbage collection (Heartbeat)\nDEFINE FIELD lastActiveAt ON TABLE _spooky_incantation TYPE datetime DEFAULT time::now()\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n-- How long this Incantation stays alive without activity\nDEFINE FIELD ttl ON TABLE _spooky_incantation TYPE duration\n    PERMISSIONS FOR select, create, update WHERE $_spooky_client_id = $clientId;\n\n\n-- Remote-only meta tables (not synced to client)\nDEFINE TABLE _spooky_module_state SCHEMALESS PERMISSIONS FULL;\n\n-- Unregister from DBSP on deletion\nDEFINE EVENT _spooky_dbsp_cleanup ON TABLE _spooky_incantation WHEN $event = \"DELETE\" THEN {\n    let $result = mod::dbsp::unregister_query(<string>$before.id);\n};\n\n-- Register with DBSP on creation or update\n-- Register with DBSP on creation or update\nDEFINE EVENT _spooky_dbsp_register ON TABLE _spooky_incantation WHEN $event = \"CREATE\" OR ($event = \"UPDATE\" AND ($after.surrealQL != $before.surrealQL OR $after.params != $before.params)) THEN {\n    LET $res = mod::dbsp::register_view(<string>$after.id, $after.surrealQL, <string>($after.params OR {}));\n    -- Update the incantation with the initial hash computed by DBSP\n    IF $res.result_hash != NONE THEN {\n        UPDATE _spooky_incantation SET hash = $res.result_hash, tree = $res.tree WHERE id = $after.id; \n    } END;\n};\n-- ==================================================\n-- FUNCTION: CALCULATE VIEW HASH\n-- Usage: fn::spooky::view_hash(thread:123, ['comments'])\n-- ==================================================\nDEFINE FUNCTION fn::spooky::view_hash($rid: record, $paths: array<string>) {\n    LET $shadow = (SELECT * FROM ONLY _spooky_data_hash WHERE recordId = $rid);\n    IF $shadow.recordId == NONE { RETURN crypto::blake3(\"\"); };\n\n    -- 1. Start with the Intrinsic Hash\n    LET $parts = [$shadow.intrinsicHash];\n\n    -- 2. Collect requested Composition Hashes (if they exist)\n    -- We use a subquery to map the $paths array to values safely\n    LET $extras = (\n        SELECT VALUE $shadow.compositionHash[$this] \n        FROM $paths \n        WHERE $shadow.compositionHash[$this] != NONE\n    );\n\n    -- 3. Combine and Aggregate\n    LET $all_parts = array::concat($parts, $extras);\n    \n    RETURN mod::xor::blake3_xor_multi($all_parts);\n};\n\n-- ==================================================\n-- FUNCTION: REGISTER INCANTATION (With Sorting)\n-- Usage: fn::incantation::register({ ... sort_field: 'created_at' ... })\n-- ==================================================\nDEFINE FUNCTION fn::incantation::register($config: object) {\n    -- UNPACK CONFIG\n    LET $id         = $config.id;\n    LET $client_id   = $config.client_id;\n    LET $items      = $config.items;\n    LET $paths      = $config.paths;\n    LET $table      = $config.table;\n    LET $filter     = $config.filter;\n    LET $query      = $config.query; -- Optional DBSP Plan (SQL String)\n    \n    -- Sorting Params (Default to created_at if missing)\n    LET $sort_field = $config.sort_field OR 'created_at';\n    LET $tree_init = {}; \n    \n    -- 1. CALCULATE AGGREGATE HASH\n    LET $hashes = (\n        SELECT VALUE fn::spooky::view_hash(id, $paths) \n        FROM $items\n    );\n    LET $query_hash = mod::xor::blake3_xor_multi($hashes);\n\n    -- 2. UPDATE INCANTATION REGISTRY\n    -- Use String Cast for ID to avoid type::thing issues during schema load\n    LET $rid_str = \"_spooky_incantation:\" + $id;\n    LET $rid = <record>$rid_str;\n    \n    INSERT INTO _spooky_incantation {\n        id:           $rid,\n        hash:         $query_hash,\n        clientId:     $client_id,\n        surrealQL:    $query,\n        tree:         <object>{},\n        lastActiveAt: time::now(),\n        ttl:          1h\n    };\n\n\n\n    -- 5. REGISTER WITH DBSP (If plan provided)\n    IF $query != NONE THEN {\n        LET $state = fn::dbsp::get_state();\n        LET $dbsp_res = mod::dbsp::register_query($id, $query, $state);\n        fn::dbsp::save_state($dbsp_res.new_state);\n        \n        LET $init_res = $dbsp_res.result;\n        IF $init_res != NONE THEN {\n            -- Update using the explicit ID\n            UPDATE $rid SET hash = $init_res.hash, tree = $init_res.tree;\n        } END;\n        \n        -- DEBUG: Return the entire result to inspect state\n        RETURN $dbsp_res;\n    } END;\n\n    RETURN $query_hash;\n};\n\nDEFINE FUNCTION fn::incantation::heartbeat($id: record) {\n    UPDATE $id SET lastActiveAt = time::now();\n};\n-- ==================================================\n-- AUTO-GENERATED SPOOKY EVENTS\n-- ==================================================\n\n-- Meta Table: _spooky_data_hash Mutation\n-- Automatically recalculates TotalHash when IntrinsicHash or CompositionHash changes\nDEFINE EVENT OVERWRITE _spooky_data_hash_mutation ON TABLE _spooky_data_hash\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $new_total = mod::xor::blake3_xor($after.intrinsicHash, $after.compositionHash._xor);\n    IF $new_total != $after.totalHash THEN {\n        UPDATE $after.id SET totalHash = $new_total;\n    } END;\n};\n\nDEFINE FIELD _spooky_touch ON TABLE comment TYPE any PERMISSIONS FOR select, create, update WHERE false;\n\n-- Table: comment Cascade Down (Reference Propagation)\n-- Table: comment Mutation\nDEFINE EVENT OVERWRITE _spooky_comment_mutation ON TABLE comment\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $xor_intrinsic = crypto::blake3(\"\");\n    LET $xor_composition = crypto::blake3(\"\");\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $new_composition = {};\n    LET $ref_hash_author = IF $after.author != NONE THEN (SELECT totalHash FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.author)))[0].totalHash ELSE crypto::blake3(\"\") END;\n    LET $ref_hash_author = IF $ref_hash_author != NONE THEN $ref_hash_author ELSE crypto::blake3(\"\") END;\n    LET $xor_composition = mod::xor::blake3_xor($xor_composition, $ref_hash_author);\n    LET $h_content = crypto::blake3(<string>$after.content OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_content);\n    LET $record_id = $before.id OR $after.id;\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$record_id)))[0];\n    LET $new_composition = {\n        author: $ref_hash_author,\n        _xor: $xor_composition,\n    };\n\n    LET $new_total_calculated = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $plain_after = {\n        id: <string>($after.id OR \"\"),\n        author: <string>($after.author OR \"\"),\n        content: $after.content,\n        created_at: <string>($after.created_at OR \"\"),\n        thread: <string>($after.thread OR \"\"),\n        IntrinsicHash: $new_total_calculated,\n        _hash: $new_total_calculated,\n        totalHash: $new_total_calculated,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('comment', $event, <string>($after.id OR \"\"), $plain_after);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.id));\n    UPSERT $hash_id CONTENT {\n        recordId: $after.id,\n        intrinsicHash: $xor_intrinsic,\n        compositionHash: $new_composition,\n        totalHash: NONE -- Placeholder, will be recalculated by event\n    };\n\n    LET $new_total = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $old_total = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE $new_total END;\n    LET $old_total_for_delta = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE crypto::blake3(\"\") END;\n    -- BUBBLE UP to Parent (thread)\n    IF $before.thread = $after.thread THEN {\n        LET $delta = mod::xor::blake3_xor($old_total_for_delta, $new_total_calculated);\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.thread));\n    } ELSE {\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $old_total_for_delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total_for_delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.thread)) AND id != NONE;\n\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $new_total_calculated),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $new_total_calculated)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.thread)) AND id != NONE;\n    } END;\n\n};\n\n-- Table: comment Deletion\nDEFINE EVENT OVERWRITE _spooky_comment_delete ON TABLE comment\nWHEN $event = \"DELETE\"\nTHEN {\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $plain_before = {\n        id: <string>($before.id OR \"\"),\n        author: <string>($before.author OR \"\"),\n        content: $before.content,\n        created_at: <string>($before.created_at OR \"\"),\n        thread: <string>($before.thread OR \"\"),\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('comment', \"DELETE\", <string>($before.id OR \"\"), $plain_before);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id)))[0];\n    LET $old_total = $old_hash_data.totalHash;\n\n    -- BUBBLE UP Delete to Parent\n    IF $old_total != NONE AND $before.thread != NONE THEN {\n        UPDATE _spooky_data_hash SET\n            compositionHash.comment = mod::xor::blake3_xor((compositionHash.comment OR $empty_hash), $old_total),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.thread));\n    } END;\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id));\n    DELETE $hash_id;\n};\n\nDEFINE FIELD _spooky_touch ON TABLE thread TYPE any PERMISSIONS FOR select, create, update WHERE false;\n\n-- Table: thread Cascade Down (Reference Propagation)\nDEFINE EVENT _spooky_z_cascade_comment_thread ON TABLE thread\nWHEN $event != \"DELETE\"\nTHEN {\n    UPDATE comment SET _spooky_touch = time::now() WHERE thread = $after.id;\n};\n\n-- Table: thread Mutation\nDEFINE EVENT OVERWRITE _spooky_thread_mutation ON TABLE thread\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $xor_intrinsic = crypto::blake3(\"\");\n    LET $xor_composition = crypto::blake3(\"\");\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $new_composition = {};\n    LET $h_active = crypto::blake3(<string>$after.active OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_active);\n    LET $h_content = crypto::blake3(<string>$after.content OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_content);\n    LET $h_title = crypto::blake3(<string>$after.title OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_title);\n    LET $record_id = $before.id OR $after.id;\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$record_id)))[0];\n    LET $h_comment = IF $old_hash_data.recordId != NONE THEN $old_hash_data.compositionHash.comment ELSE crypto::blake3(\"\") END;\n    LET $xor_composition = mod::xor::blake3_xor($xor_composition, $h_comment);\n    LET $new_composition = {\n        comment: $h_comment,\n        _xor: $xor_composition,\n    };\n\n    LET $new_total_calculated = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $plain_after = {\n        id: <string>($after.id OR \"\"),\n        active: $after.active,\n        author: <string>($after.author OR \"\"),\n        content: $after.content,\n        created_at: <string>($after.created_at OR \"\"),\n        title: $after.title,\n        IntrinsicHash: $new_total_calculated,\n        _hash: $new_total_calculated,\n        totalHash: $new_total_calculated,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('thread', $event, <string>($after.id OR \"\"), $plain_after);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.id));\n    UPSERT $hash_id CONTENT {\n        recordId: $after.id,\n        intrinsicHash: $xor_intrinsic,\n        compositionHash: $new_composition,\n        totalHash: NONE -- Placeholder, will be recalculated by event\n    };\n\n    LET $new_total = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $old_total = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE $new_total END;\n    LET $old_total_for_delta = IF $old_hash_data.recordId != NONE THEN $old_hash_data.totalHash ELSE crypto::blake3(\"\") END;\n    -- BUBBLE UP to Parent (author)\n    IF $before.author = $after.author THEN {\n        LET $delta = mod::xor::blake3_xor($old_total_for_delta, $new_total_calculated);\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.author));\n    } ELSE {\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $old_total_for_delta),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total_for_delta)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.author)) AND id != NONE;\n\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $new_total_calculated),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $new_total_calculated)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.author)) AND id != NONE;\n    } END;\n\n};\n\n-- Table: thread Deletion\nDEFINE EVENT OVERWRITE _spooky_thread_delete ON TABLE thread\nWHEN $event = \"DELETE\"\nTHEN {\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $plain_before = {\n        id: <string>($before.id OR \"\"),\n        active: $before.active,\n        author: <string>($before.author OR \"\"),\n        content: $before.content,\n        created_at: <string>($before.created_at OR \"\"),\n        title: $before.title,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('thread', \"DELETE\", <string>($before.id OR \"\"), $plain_before);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id)))[0];\n    LET $old_total = $old_hash_data.totalHash;\n\n    -- BUBBLE UP Delete to Parent\n    IF $old_total != NONE AND $before.author != NONE THEN {\n        UPDATE _spooky_data_hash SET\n            compositionHash.thread = mod::xor::blake3_xor((compositionHash.thread OR $empty_hash), $old_total),\n            compositionHash._xor = mod::xor::blake3_xor(compositionHash._xor, $old_total)\n        WHERE id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.author));\n    } END;\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id));\n    DELETE $hash_id;\n};\n\nDEFINE FIELD _spooky_touch ON TABLE user TYPE any PERMISSIONS FOR select, create, update WHERE false;\n\n-- Table: user Cascade Down (Reference Propagation)\nDEFINE EVENT _spooky_z_cascade_comment_author ON TABLE user\nWHEN $event != \"DELETE\"\nTHEN {\n    UPDATE comment SET _spooky_touch = time::now() WHERE author = $after.id;\n};\n\nDEFINE EVENT _spooky_z_cascade_thread_author ON TABLE user\nWHEN $event != \"DELETE\"\nTHEN {\n    UPDATE thread SET _spooky_touch = time::now() WHERE author = $after.id;\n};\n\n-- Table: user Mutation\nDEFINE EVENT OVERWRITE _spooky_user_mutation ON TABLE user\nWHEN $before != $after AND $event != \"DELETE\"\nTHEN {\n    LET $xor_intrinsic = crypto::blake3(\"\");\n    LET $xor_composition = crypto::blake3(\"\");\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $new_composition = {};\n    LET $h_username = crypto::blake3(<string>$after.username OR \"\");\n    LET $xor_intrinsic = mod::xor::blake3_xor($xor_intrinsic, $h_username);\n    LET $record_id = $before.id OR $after.id;\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$record_id)))[0];\n    LET $h_thread = IF $old_hash_data.recordId != NONE THEN $old_hash_data.compositionHash.thread ELSE crypto::blake3(\"\") END;\n    LET $xor_composition = mod::xor::blake3_xor($xor_composition, $h_thread);\n    LET $new_composition = {\n        thread: $h_thread,\n        _xor: $xor_composition,\n    };\n\n    LET $new_total_calculated = mod::xor::blake3_xor($xor_intrinsic, $xor_composition);\n    LET $plain_after = {\n        id: <string>($after.id OR \"\"),\n        created_at: <string>($after.created_at OR \"\"),\n        password: $after.password,\n        username: $after.username,\n        IntrinsicHash: $new_total_calculated,\n        _hash: $new_total_calculated,\n        totalHash: $new_total_calculated,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('user', $event, <string>($after.id OR \"\"), $plain_after);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$after.id));\n    UPSERT $hash_id CONTENT {\n        recordId: $after.id,\n        intrinsicHash: $xor_intrinsic,\n        compositionHash: $new_composition,\n        totalHash: NONE -- Placeholder, will be recalculated by event\n    };\n\n    -- ==================================================\n    -- CASCADE DOWN (Disabled for Object Hash for now)\n    -- Logic: {} Change -> Updates Dependent INTRINSIC Hash\n    -- ==================================================\n    -- (Skipped implementation for object hash)\n\n};\n\n-- Table: user Deletion\nDEFINE EVENT OVERWRITE _spooky_user_delete ON TABLE user\nWHEN $event = \"DELETE\"\nTHEN {\n    LET $empty_hash = crypto::blake3(\"\");\n    LET $plain_before = {\n        id: <string>($before.id OR \"\"),\n        created_at: <string>($before.created_at OR \"\"),\n        password: $before.password,\n        username: $before.username,\n    };\n    LET $dbsp_ok = mod::dbsp::ingest('user', \"DELETE\", <string>($before.id OR \"\"), $plain_before);\n    FOR $u IN $dbsp_ok.updates {\n        UPDATE _spooky_incantation SET hash = $u.result_hash, tree = $u.tree WHERE id = $u.query_id;\n    };\n    LET $saved = mod::dbsp::save_state(NONE);\n\n    LET $old_hash_data = (SELECT * FROM <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id)))[0];\n    LET $old_total = $old_hash_data.totalHash;\n\n    LET $hash_id = <record>(\"_spooky_data_hash:\" + crypto::blake3(<string>$before.id));\n    DELETE $hash_id;\n};\n\n" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m25361[0m
[2m2025-12-30T20:26:53.582097Z[0m [34mDEBUG[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::iam::file[0m[2m:[0m Allowed bucket folder path: /modules [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.585100Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"25408" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"ca3f517a-7bab-4f1a-b70f-3b62c3dcae51" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m3[0m
[2m2025-12-30T20:26:53.590409Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.590451Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.590466Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.590513Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:53.590607Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"RETURN mod::dbsp::reset({})" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m27[0m
[2m2025-12-30T20:26:53.590674Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::reset' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.534674Z[0m [35mTRACE[0m [1mupdate_node[0m: [2msurrealdb::core::kvs::ds[0m[2m:[0m Updating node in the cluster [3mid[0m[2m=[0m39ff6b30-798a-4638-b4c0-6a90f82dca66
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.826522Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"DELETE _spooky_module_state:dbsp" [3mlength[0m[2m=[0m32[0m [2m[3minput[0m[2m=[0m"DELETE _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m32[0m
[2m2025-12-30T20:26:56.826577Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mDELETE _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.826857Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"73" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"cab2ff31-156d-4715-b401-d00cb88c6386" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m3236[0m
[2m2025-12-30T20:26:56.829771Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.829790Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.829807Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.829858Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.829921Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_users_incr\", \"SELECT * FROM users_incr WHERE id = 'users_incr:active:1'\", {});\n            \n            LET $r2 = mod::dbsp::ingest(\"users_incr\", \"CREATE\", \"users_incr:active:1\", { name: \"Alice\", active: true, hash: \"0000\" });\n            RETURN $r2.updates;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m321[0m
[2m2025-12-30T20:26:56.829976Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.830722Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.830774Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.830882Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m313[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m313[0m
[2m2025-12-30T20:26:56.830912Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.831362Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "hash": String("0000"), "name": String("Alice")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.831981Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.832020Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_users_incr, delta_len=1, hash=2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.832374Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m543[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m543[0m
[2m2025-12-30T20:26:56.832420Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
  console.log
    DEBUG: res2: [null,null,[{"query_id":"view_users_incr","result_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","result_ids":["users_incr:active:1"],"tree":{"hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","leaves":[{"hash":"0000","id":"users_incr:active:1"}]}}]]

      at Object.<anonymous> (surrealdb/dbsp.test.ts:49:13)

[2m2025-12-30T20:26:56.832898Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"368" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"21b256ea-6288-4216-8a8f-e9b64df49ab3" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m3[0m
[2m2025-12-30T20:26:56.836100Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.836120Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.836139Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.836180Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.836228Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_users_active\", \"SELECT * FROM users WHERE id = 'users:active*'\", {});\n            \n            LET $r2 = mod::dbsp::register_view(\"view_threads_recent\", \"SELECT * FROM threads WHERE id = 'threads:2024*'\", {});\n            \n            LET $u_res = mod::dbsp::ingest(\"users\", \"CREATE\", \"users:active:99\", {\"name\":\"Bob\",\"active\":true,\"hash\":\"0000\"});\n            \n            LET $t_res = mod::dbsp::ingest(\"threads\", \"CREATE\", \"threads:2024:1\", {\"title\":\"Hello\",\"hash\":\"0000\"});\n            \n            RETURN {\n                user_updates: $u_res.updates,\n                thread_updates: $t_res.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m682[0m
[2m2025-12-30T20:26:56.836336Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.837013Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.837056Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.837292Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m732[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m732[0m
[2m2025-12-30T20:26:56.837363Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.837657Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.838154Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.838182Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.838418Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m925[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m925[0m
[2m2025-12-30T20:26:56.838465Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.838714Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "hash": String("0000"), "name": String("Bob")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.839182Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.839212Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_users_active, delta_len=1, hash=38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.839629Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1132[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1132[0m
[2m2025-12-30T20:26:56.839672Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.840054Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "title": String("Hello")}
[2m2025-12-30T20:26:56.840567Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.840616Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_threads_recent, delta_len=1, hash=3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.840989Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1329[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1329[0m
[2m2025-12-30T20:26:56.841030Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.841601Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"729" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"c44c2201-50c7-4435-af6b-36d310845200" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m5[0m
[2m2025-12-30T20:26:56.845037Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.845057Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.845073Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.845119Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.845176Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"RETURN mod::dbsp::register_view(\"view_users_threads_join\", \"SELECT * FROM users, threads WHERE users.id = threads.author AND users.id = 'users:active*'\", {})" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m157[0m
[2m2025-12-30T20:26:56.845236Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.845993Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.846045Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.846424Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1633[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1633[0m
[2m2025-12-30T20:26:56.846476Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.846770Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"203" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"df7f3aff-3ab2-42d4-beeb-152c33d43a54" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m1[0m
[2m2025-12-30T20:26:56.850282Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.850298Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.850314Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.850354Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.850391Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_tree_test\", \"SELECT * FROM tree_items WHERE id = 'item*'\", {});\n            \n            LET $r2 = mod::dbsp::ingest(\"tree_items\", \"CREATE\", \"item:1\", {\"id\":\"item:1\",\"val\":\"A\",\"hash\":\"0000\"});\n            \n            LET $r3 = mod::dbsp::ingest(\"tree_items\", \"CREATE\", \"item:2\", {\"id\":\"item:2\",\"val\":\"B\",\"hash\":\"0001\"});\n            \n            LET $r4 = mod::dbsp::ingest(\"tree_items\", \"DELETE\", \"item:1\", {\"id\":\"item:1\",\"val\":\"A\",\"hash\":\"0000\"});\n            \n            RETURN $r1;\n            RETURN $r2.updates;\n            RETURN $r3.updates;\n            RETURN $r4.updates;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m646[0m
[2m2025-12-30T20:26:56.850439Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.850972Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.851002Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.851432Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m1816[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m1816[0m
[2m2025-12-30T20:26:56.851474Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.851751Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": String("item:1"), "val": String("A")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.852297Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.852353Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_tree_test, delta_len=1, hash=9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.852859Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:1\":1},\"last_hash\":\"9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2003[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:1\":1},\"last_hash\":\"9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2003[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.852898Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:1":1},"rows":{"item:1":{"hash":"0000","id":"item:1","val":"A"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:1":1},"last_hash":"9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff","params":{}}]}'
[2m2025-12-30T20:26:56.853329Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0001"), "id": String("item:2"), "val": String("B")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.853868Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.853897Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_tree_test, delta_len=1, hash=e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51, last_hash=9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.854415Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1,\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"},\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:1\":1,\"item:2\":1},\"last_hash\":\"e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2074[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1,\"item:1\":1},\"rows\":{\"item:1\":{\"hash\":\"0000\",\"id\":\"item:1\",\"val\":\"A\"},\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:1\":1,\"item:2\":1},\"last_hash\":\"e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2074[0m
[2m2025-12-30T20:26:56.854466Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1,"item:1":1},"rows":{"item:1":{"hash":"0000","id":"item:1","val":"A"},"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:1":1,"item:2":1},"last_hash":"e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.854896Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": String("item:1"), "val": String("A")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.855252Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.855280Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_tree_test, delta_len=1, hash=7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6, last_hash=e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.855962Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2003[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2003[0m
[2m2025-12-30T20:26:56.856009Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.856685Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"694" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"3e02f902-16fa-4a29-b682-c0a666f7fc41" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m6[0m
  console.log
    DEBUG: Tree Test Results: [
      null,
      null,
      null,
      null,
      {
        "id": "view_tree_test",
        "msg": "Registered"
      },
      [
        {
          "query_id": "view_tree_test",
          "result_hash": "9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff",
          "result_ids": [
            "item:1"
          ],
          "tree": {
            "hash": "9d2b6ac856371f3eefe40e89602132d41c1ba3eed323132113707d982bc9b8ff",
            "leaves": [
              {
                "hash": "0000",
                "id": "item:1"
              }
            ]
          }
        }
      ],
      [
        {
          "query_id": "view_tree_test",
          "result_hash": "e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51",
          "result_ids": [
            "item:1",
            "item:2"
          ],
          "tree": {
            "hash": "e089d909b60cd87171b6c5cd6892be36867bc2149241822636cbc16ef475fa51",
            "leaves": [
              {
                "hash": "0000",
                "id": "item:1"
              },
              {
                "hash": "0000",
                "id": "item:2"
              }
            ]
          }
        }
      ],
      [
        {
          "query_id": "view_tree_test",
          "result_hash": "7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6",
          "result_ids": [
            "item:2"
          ],
          "tree": {
            "hash": "7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6",
            "leaves": [
              {
                "hash": "0000",
                "id": "item:2"
              }
            ]
          }
        }
      ]
    ]

      at Object.<anonymous> (surrealdb/dbsp.test.ts:131:13)

[2m2025-12-30T20:26:56.859374Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.859389Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.859401Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.859432Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.859471Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_join_sql\", \"SELECT * FROM users, posts WHERE users.id = posts.author\", {});\n            \n            LET $u = { id: 1, name: \"Alice\", hash: \"0000\" };\n            LET $r2 = mod::dbsp::ingest(\"users\", \"CREATE\", \"users:1\", $u);\n            \n            LET $p = { id: 10, author: 1, title: \"Hello\", hash: \"0001\" };\n            LET $r3 = mod::dbsp::ingest(\"posts\", \"CREATE\", \"posts:10\", $p);\n            \n            RETURN {\n                reg: $r1.msg,\n                user_updates: $r2.updates,\n                post_updates: $r3.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m614[0m
[2m2025-12-30T20:26:56.859530Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.860166Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.860200Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.860718Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2217[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2217[0m
[2m2025-12-30T20:26:56.860794Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users":{"name":"users","zset":{"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.861198Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(1), "name": String("Alice")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.861709Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.861759Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.862235Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2277[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2277[0m
[2m2025-12-30T20:26:56.862276Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.862626Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0001"), "id": Number(10), "title": String("Hello")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.863145Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.863180Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_join_sql, delta_len=1, hash=eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.863786Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2470[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2470[0m
[2m2025-12-30T20:26:56.863846Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.864314Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"662" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"40ef4259-5706-4c2b-be84-8e0fab97e8bb" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m4[0m
[2m2025-12-30T20:26:56.866399Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.866418Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.866433Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.866481Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.866514Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_limit_eviction\", \"SELECT * FROM users_limit LIMIT 1\", {});\n            \n            // Ingest User A (id 20)\n            LET $u1 = { id: 20, name: \"A\", hash: \"0000\" };\n            LET $r2 = mod::dbsp::ingest(\"users_limit\", \"CREATE\", \"users_limit:20\", $u1);\n            \n            // Ingest User B (id 10 - smaller, should evict A)\n            LET $u2 = { id: 10, name: \"B\", hash: \"0001\" };\n            LET $r3 = mod::dbsp::ingest(\"users_limit\", \"CREATE\", \"users_limit:10\", $u2);\n            \n            RETURN {\n                up1: $r2.updates,\n                up2: $r3.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m659[0m
[2m2025-12-30T20:26:56.866557Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.867098Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.867130Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.867692Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2638[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2638[0m
[2m2025-12-30T20:26:56.867763Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.868065Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(20), "name": String("A")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.868580Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.868603Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_limit_eviction, delta_len=1, hash=d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.869224Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:20\":1},\"last_hash\":\"d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2846[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:20\":1},\"last_hash\":\"d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2846[0m
[2m2025-12-30T20:26:56.869282Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:20":1},"last_hash":"d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.869926Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0001"), "id": Number(10), "name": String("B")}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.870475Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.870504Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_limit_eviction, delta_len=2, hash=3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775, last_hash=d9bc933647b22a251e773d68e4f97f58d1b5b21f15c414c3b9fecf70c273e64a
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.871171Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m2917[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2917[0m
[2m2025-12-30T20:26:56.871235Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.871727Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"707" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a3f69d45-b76f-4a0e-8bca-9c5ef925032b" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m5[0m
[2m2025-12-30T20:26:56.873985Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.874008Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.874023Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.874063Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.874111Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_nested_limit\", \"SELECT *, (SELECT * FROM post WHERE author=$parent.id LIMIT 2) FROM user\", {});\n            RETURN $r1;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m182[0m
[2m2025-12-30T20:26:56.874158Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.874981Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.875032Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.875712Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3298[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3298[0m
[2m2025-12-30T20:26:56.875798Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.876203Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"229" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"beded8ec-29f1-4d1b-b438-4c632acb630c" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m2[0m
[2m2025-12-30T20:26:56.881513Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.881535Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.881548Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.881584Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.881625Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r_v1 = mod::dbsp::register_view(\"view_active\", \"SELECT * FROM user WHERE status = 'active'\", {});\n            LET $r_v2 = mod::dbsp::register_view(\"view_u_p\", \"SELECT * FROM user, post WHERE user.id = post.author\", {});\n            LET $r_v3 = mod::dbsp::register_view(\"view_feed\", \"SELECT * FROM post LIMIT 3\", {});\n            \n            // ... Actions (same as before) ...\n            // Action 1: Create Users\n            LET $ua = { id: 1, status: 'active', hash: \"0000\" };\n            LET $ub = { id: 2, status: 'inactive', hash: \"0000\" };\n            \n            LET $r_a1 = mod::dbsp::ingest(\"user\", \"CREATE\", \"user:1\", $ua);\n            \n            LET $r_a2 = mod::dbsp::ingest(\"user\", \"CREATE\", \"user:2\", $ub);\n            \n            // Action 2: Posts for A\n            LET $p1 = { id: 10, author: 1, hash: \"0000\" };\n            LET $r_p1 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:10\", $p1);\n            \n            LET $p2 = { id: 11, author: 1, hash: \"0000\" };\n            LET $r_p2 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:11\", $p2);\n            \n            // Action 3: Update User B -> Active\n            LET $ub_active = { id: 2, status: 'active', hash: \"0001\" };\n            LET $r_upd = mod::dbsp::ingest(\"user\", \"UPDATE\", \"user:2\", $ub_active);\n            \n            // Action 4: Posts for B\n            LET $p3 = { id: 12, author: 2, hash: \"0000\" };\n            LET $r_p3 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:12\", $p3);\n            \n            LET $p4 = { id: 13, author: 2, hash: \"0000\" };\n            LET $r_p4 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:13\", $p4);\n            \n            // Action 5: Post 0 (Smallest ID)\n            // Use padded ID to ensure \"post:05\" < \"post:10\" lexicographically\n            LET $p0 = { id: 5, author: 1, hash: \"0000\" };\n            LET $r_p0 = mod::dbsp::ingest(\"post\", \"CREATE\", \"post:05\", $p0);\n            \n            RETURN {\n                user1: $r_a1.updates,\n                user2: $r_a2.updates,\n                post1: $r_p1.updates,\n                user_upt: $r_upd.updates,\n                post4: $r_p4.updates,\n                post0: $r_p0.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m2193[0m
[2m2025-12-30T20:26:56.881718Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.882338Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.882377Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.883057Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3486[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3486[0m
[2m2025-12-30T20:26:56.883139Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.883563Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.884116Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.884141Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.884815Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3693[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3693[0m
[2m2025-12-30T20:26:56.884872Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.885270Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.885743Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.885766Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.886428Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m3844[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m3844[0m
[2m2025-12-30T20:26:56.886480Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.886827Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(1), "status": String("active")}
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.887432Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.887457Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_nested_limit, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=
DEBUG: process: view=view_active, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.888284Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4094[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4094[0m
[2m2025-12-30T20:26:56.888354Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"user":{"name":"user","zset":{"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.888911Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(2), "status": String("inactive")}
[2m2025-12-30T20:26:56.889316Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.889363Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_nested_limit, delta_len=1, hash=4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.890252Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":1,\"user:1\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4168[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":1,\"user:1\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4168[0m
[2m2025-12-30T20:26:56.890309Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"user":{"name":"user","zset":{"user:2":1,"user:1":1},"rows":{"user:2":{"hash":"0000","id":2,"status":"inactive"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":1,"user:1":1},"last_hash":"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.890877Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0000"), "id": Number(10)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.891401Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.891425Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_u_p, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=
DEBUG: process: view=view_feed, delta_len=1, hash=eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.892299Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1},\"last_hash\":\"eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4415[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":1,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1},\"last_hash\":\"eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4415[0m
[2m2025-12-30T20:26:56.892409Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"user":{"name":"user","zset":{"user:2":1,"user:1":1},"rows":{"user:2":{"hash":"0000","id":2,"status":"inactive"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"post":{"name":"post","zset":{"post:10":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":1},"last_hash":"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1},"last_hash":"eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.893050Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0000"), "id": Number(11)}
[2m2025-12-30T20:26:56.893586Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.893621Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_u_p, delta_len=1, hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
DEBUG: process: view=view_feed, delta_len=1, hash=ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f, last_hash=eeec759e956dd2902245d57e90b7f4285e88f84edd885f6dd92927efb13c4fa8
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.894650Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":1},\"rows\":{\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4484[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":1},\"rows\":{\"user:2\":{\"hash\":\"0000\",\"id\":2,\"status\":\"inactive\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":1},\"last_hash\":\"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4484[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.894711Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":1},"rows":{"user:2":{"hash":"0000","id":2,"status":"inactive"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"post":{"name":"post","zset":{"post:11":1,"post:10":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":1},"last_hash":"4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1},"last_hash":"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f","params":{}}]}'
[2m2025-12-30T20:26:56.895202Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0001"), "id": Number(2), "status": String("active")}
[2m2025-12-30T20:26:56.895750Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.895782Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_nested_limit, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=4c881139ee4eb219f84699805751eac387952cd5594f2582aa681aec611a535f
DEBUG: process: view=view_active, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.896846Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4493[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2},\"last_hash\":\"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1},\"last_hash\":\"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4493[0m
[2m2025-12-30T20:26:56.896920Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"post":{"name":"post","zset":{"post:11":1,"post:10":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2},"last_hash":"aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1},"last_hash":"ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.897658Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(2), "hash": String("0000"), "id": Number(12)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.898071Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.898099Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_u_p, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=aacca82818e7ff18b6067e9233c6d5d54021fa1f5a9c2fe9b134ccc6c77a5c52
DEBUG: process: view=view_feed, delta_len=1, hash=7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec, last_hash=ac62479d17fff0733fd0a70b1f8aa9744fb5e93c3e015f33368c6dedebc7dd9f
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.899027Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:12\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4573[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:12\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4573[0m
[2m2025-12-30T20:26:56.899103Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"post":{"name":"post","zset":{"post:10":1,"post:12":1,"post:11":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12},"post:11":{"author":1,"hash":"0000","id":11}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1,"post:12":1},"last_hash":"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.899773Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(2), "hash": String("0000"), "id": Number(13)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.900132Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.900158Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_u_p, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.901175Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:11\":1,\"post:13\":1,\"post:12\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:12\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4630[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:11\":1,\"post:13\":1,\"post:12\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":2,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:12\":1},\"last_hash\":\"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4630[0m
[2m2025-12-30T20:26:56.901246Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"post":{"name":"post","zset":{"post:10":1,"post:11":1,"post:13":1,"post:12":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13},"post:11":{"author":1,"hash":"0000","id":11}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":2,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1,"post:12":1},"last_hash":"7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.901601Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"author": Number(1), "hash": String("0000"), "id": Number(5)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.902202Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.902231Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: process: view=view_u_p, delta_len=1, hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78, last_hash=02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78
DEBUG: process: view=view_feed, delta_len=2, hash=7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033, last_hash=7602f7c000b60d48a30bb99bf9e9a7b19279df77d2f7ea9ca5d5caa4058e4cec
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.903316Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:10\":1,\"post:11\":1,\"post:12\":1,\"post:05\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4686[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"post\":{\"name\":\"post\",\"zset\":{\"post:13\":1,\"post:10\":1,\"post:11\":1,\"post:12\":1,\"post:05\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4686[0m
[2m2025-12-30T20:26:56.903395Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"post":{"name":"post","zset":{"post:13":1,"post:10":1,"post:11":1,"post:12":1,"post:05":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:11":{"author":1,"hash":"0000","id":11},"post:13":{"author":2,"hash":"0000","id":13},"post:10":{"author":1,"hash":"0000","id":10},"post:05":{"author":1,"hash":"0000","id":5}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:05":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.903998Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"2241" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"69e056f6-cf7b-47fc-95ba-a5c6c4f95dea" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m22[0m
[2m2025-12-30T20:26:56.906449Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.906477Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.906498Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.906548Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.906595Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"view_order\", \"SELECT * FROM items ORDER BY val DESC LIMIT 2\", {});\n            LET $r2 = mod::dbsp::register_view(\"view_or\", \"SELECT * FROM items WHERE val = 10 OR val = 100\", {});\n            \n            // Ingest\n            LET $i1 = { id: 1, val: 10, hash: \"0000\" };\n            LET $i2 = { id: 2, val: 20, hash: \"0000\" };\n            LET $i3 = { id: 3, val: 100, hash: \"0000\" };\n            \n            LET $res1 = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:1\", $i1);\n            LET $res2 = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:2\", $i2);\n            LET $res3 = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:3\", $i3);\n            \n            RETURN {\n                up1: $res1.updates,\n                up2: $res2.updates,\n                up3: $res3.updates\n            };\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m845[0m
[2m2025-12-30T20:26:56.906663Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.907357Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.907399Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.908365Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:10\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m4871[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:10\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m4871[0m
[2m2025-12-30T20:26:56.908432Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"post":{"name":"post","zset":{"post:05":1,"post:10":1,"post:12":1,"post:13":1,"post:11":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:05":{"author":1,"hash":"0000","id":5},"post:12":{"author":2,"hash":"0000","id":12},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.908852Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.909411Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.909442Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.910310Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:13\":1,\"post:05\":1,\"post:12\":1,\"post:10\":1},\"rows\":{\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5116[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:13\":1,\"post:05\":1,\"post:12\":1,\"post:10\":1},\"rows\":{\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5116[0m
[2m2025-12-30T20:26:56.910388Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"post":{"name":"post","zset":{"post:11":1,"post:13":1,"post:05":1,"post:12":1,"post:10":1},"rows":{"post:13":{"author":2,"hash":"0000","id":13},"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:11":{"author":1,"hash":"0000","id":11}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.910798Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(1), "val": Number(10)}
[2m2025-12-30T20:26:56.911191Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.911212Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=1, hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa, last_hash=
DEBUG: process: view=view_or, delta_len=1, hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.912293Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:11\":1,\"post:05\":1,\"post:13\":1},\"rows\":{\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5363[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:12\":1,\"post:11\":1,\"post:05\":1,\"post:13\":1},\"rows\":{\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5363[0m
[2m2025-12-30T20:26:56.912370Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"items":{"name":"items","zset":{"items:1":1},"rows":{"items:1":{"hash":"0000","id":1,"val":10}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"post":{"name":"post","zset":{"post:10":1,"post:12":1,"post:11":1,"post:05":1,"post:13":1},"rows":{"post:13":{"author":2,"hash":"0000","id":13},"post:12":{"author":2,"hash":"0000","id":12},"post:11":{"author":1,"hash":"0000","id":11},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:1":1},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.912992Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(2), "val": Number(20)}
[2m2025-12-30T20:26:56.913408Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.913435Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=1, hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a, last_hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.914550Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:2\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:10\":1,\"post:11\":1,\"post:05\":1,\"post:13\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:05\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:1\":1},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5429[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:2\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:12\":1,\"post:10\":1,\"post:11\":1,\"post:05\":1,\"post:13\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:05\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:1\":1},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5429[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.914656Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"items":{"name":"items","zset":{"items:1":1,"items:2":1},"rows":{"items:2":{"hash":"0000","id":2,"val":20},"items:1":{"hash":"0000","id":1,"val":10}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"post":{"name":"post","zset":{"post:12":1,"post:10":1,"post:11":1,"post:05":1,"post:13":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13},"post:05":{"author":1,"hash":"0000","id":5}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:05":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":1,"items:1":1},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}}]}'
[2m2025-12-30T20:26:56.915248Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"hash": String("0000"), "id": Number(3), "val": Number(100)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.915782Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.915826Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=2, hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f, last_hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a
DEBUG: process: view=view_or, delta_len=1, hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd, last_hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.916974Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:1\":1,\"items:3\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:12\":1,\"post:05\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:05\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1,\"items:3\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5496[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:1\":1,\"items:3\":1},\"rows\":{\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:12\":1,\"post:05\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:11\":1,\"post:10\":1,\"post:05\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:1\":1,\"items:3\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5496[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.917032Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"items":{"name":"items","zset":{"items:2":1,"items:1":1,"items:3":1},"rows":{"items:1":{"hash":"0000","id":1,"val":10},"items:3":{"hash":"0000","id":3,"val":100},"items:2":{"hash":"0000","id":2,"val":20}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"post":{"name":"post","zset":{"post:11":1,"post:12":1,"post:05":1,"post:13":1,"post:10":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:11":{"author":1,"hash":"0000","id":11},"post:13":{"author":2,"hash":"0000","id":13}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:11":1,"post:10":1,"post:05":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:3":1,"items:2":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:1":1,"items:3":1},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}}]}'
[2m2025-12-30T20:26:56.917822Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"893" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"a0034116-2147-405d-b3da-7fc24a3c5514" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m11[0m
[2m2025-12-30T20:26:56.920228Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.920252Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.920268Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.920337Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.920397Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"\n            LET $r1 = mod::dbsp::register_view(\"complex_filter\", \"SELECT * FROM items WHERE (category = 'A' OR category = 'B') AND active = true\", {});\n            LET $r2 = mod::dbsp::register_view(\"multi_order\", \"SELECT * FROM items ORDER BY category ASC, score DESC LIMIT 2\", {});\n            \n            LET $i1 = { category: 'A', score: 10, active: true, hash: \"0000\" };\n            LET $i2 = { category: 'A', score: 20, active: false, hash: \"0000\" };\n            LET $i3 = { category: 'B', score: 10, active: true, hash: \"0000\" };\n            LET $i4 = { category: 'A', score: 30, active: true, hash: \"0000\" };\n            \n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:1\", $i1);\n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:2\", $i2);\n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:3\", $i3);\n            LET $res = mod::dbsp::ingest(\"items\", \"CREATE\", \"items:4\", $i4);\n            \n            RETURN $res.updates;\n        " [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m994[0m
[2m2025-12-30T20:26:56.920461Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.920929Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.920952Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.921950Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:1\":1,\"items:3\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:12\":1,\"post:05\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1,\"items:1\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5684[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:1\":1,\"items:3\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:12\":1,\"post:05\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":1,\"items:3\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1,\"items:1\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5684[0m
[2m2025-12-30T20:26:56.922025Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"items":{"name":"items","zset":{"items:2":1,"items:1":1,"items:3":1},"rows":{"items:2":{"hash":"0000","id":2,"val":20},"items:3":{"hash":"0000","id":3,"val":100},"items:1":{"hash":"0000","id":1,"val":10}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"post":{"name":"post","zset":{"post:11":1,"post:12":1,"post:05":1,"post:13":1,"post:10":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:12":{"author":2,"hash":"0000","id":12},"post:11":{"author":1,"hash":"0000","id":11},"post:13":{"author":2,"hash":"0000","id":13}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:05":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":1,"items:3":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1,"items:1":1},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.922495Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::register_view' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.923150Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.923206Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.924396Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:05\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:3\":1,\"items:2\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1,\"items:1\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m5911[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:05\":1,\"post:12\":1,\"post:13\":1,\"post:11\":1},\"rows\":{\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:1\":1,\"items:3\":1,\"items:2\":1},\"rows\":{\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20},\"items:1\":{\"hash\":\"0000\",\"id\":1,\"val\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1,\"items:1\":1},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{},\"last_hash\":\"\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m5911[0m
[2m2025-12-30T20:26:56.924483Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"post":{"name":"post","zset":{"post:10":1,"post:05":1,"post:12":1,"post:13":1,"post:11":1},"rows":{"post:10":{"author":1,"hash":"0000","id":10},"post:05":{"author":1,"hash":"0000","id":5},"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12},"post:13":{"author":2,"hash":"0000","id":13}}},"items":{"name":"items","zset":{"items:1":1,"items:3":1,"items:2":1},"rows":{"items:2":{"hash":"0000","id":2,"val":20},"items:1":{"hash":"0000","id":1,"val":10},"items:3":{"hash":"0000","id":3,"val":100}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:3":1,"items:2":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1,"items:1":1},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{},"last_hash":"","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.925028Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "category": String("A"), "hash": String("0000"), "score": Number(10)}
[2m2025-12-30T20:26:56.925643Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.925679Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_or, delta_len=1, hash=4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d, last_hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd
DEBUG: process: view=complex_filter, delta_len=1, hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa, last_hash=
DEBUG: process: view=multi_order, delta_len=2, hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f, last_hash=
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.927151Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:05\":1,\"post:13\":1,\"post:11\":1,\"post:12\":1},\"rows\":{\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:3\":1,\"items:1\":2},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6085[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:10\":1,\"post:05\":1,\"post:13\":1,\"post:11\":1,\"post:12\":1},\"rows\":{\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":1,\"items:3\":1,\"items:1\":2},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"hash\":\"0000\",\"id\":2,\"val\":20}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:1\":1,\"user:2\":2},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:10\":1,\"post:05\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":1},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6085[0m
[2m2025-12-30T20:26:56.927241Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"post":{"name":"post","zset":{"post:10":1,"post:05":1,"post:13":1,"post:11":1,"post:12":1},"rows":{"post:13":{"author":2,"hash":"0000","id":13},"post:10":{"author":1,"hash":"0000","id":10},"post:05":{"author":1,"hash":"0000","id":5},"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12}}},"items":{"name":"items","zset":{"items:2":1,"items:3":1,"items:1":2},"rows":{"items:1":{"active":true,"category":"A","hash":"0000","score":10},"items:3":{"hash":"0000","id":3,"val":100},"items:2":{"hash":"0000","id":2,"val":20}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"user":{"name":"user","zset":{"user:1":1,"user:2":2},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:10":1,"post:05":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:3":1,"items:2":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1},"last_hash":"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:1":2},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:3":1,"items:2":1},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.928529Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(false), "category": String("A"), "hash": String("0000"), "score": Number(20)}
[2m2025-12-30T20:26:56.929072Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.929111Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=2, hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd, last_hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f
DEBUG: process: view=multi_order, delta_len=1, hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f, last_hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.930383Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:12\":1,\"post:05\":1,\"post:10\":1,\"post:13\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:3\":1,\"items:2\":2,\"items:1\":2},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:1\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":2},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6110[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"users\":{\"name\":\"users\",\"zset\":{\"users:1\":1,\"users:active:99\":1},\"rows\":{\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"},\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:12\":1,\"post:05\":1,\"post:10\":1,\"post:13\":1},\"rows\":{\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:3\":1,\"items:2\":2,\"items:1\":2},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"hash\":\"0000\",\"id\":3,\"val\":100},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:11\":1,\"post:10\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:1\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{\"items:3\":1},\"last_hash\":\"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2},\"last_hash\":\"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:3\":1,\"items:2\":2},\"last_hash\":\"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6110[0m
[2m2025-12-30T20:26:56.930469Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"users":{"name":"users","zset":{"users:1":1,"users:active:99":1},"rows":{"users:1":{"hash":"0000","id":1,"name":"Alice"},"users:active:99":{"active":true,"hash":"0000","name":"Bob"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"post":{"name":"post","zset":{"post:11":1,"post:12":1,"post:05":1,"post:10":1,"post:13":1},"rows":{"post:11":{"author":1,"hash":"0000","id":11},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13},"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5}}},"items":{"name":"items","zset":{"items:3":1,"items:2":2,"items:1":2},"rows":{"items:1":{"active":true,"category":"A","hash":"0000","score":10},"items:3":{"hash":"0000","id":3,"val":100},"items:2":{"active":false,"category":"A","hash":"0000","score":20}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:11":1,"post:10":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:3":1,"items:1":2},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{"items:3":1},"last_hash":"4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:1":2},"last_hash":"e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:3":1,"items:2":2},"last_hash":"fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.931138Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "category": String("B"), "hash": String("0000"), "score": Number(10)}
[2m2025-12-30T20:26:56.931645Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.931680Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=view_order, delta_len=2, hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a, last_hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd
DEBUG: process: view=view_or, delta_len=1, hash=af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262, last_hash=4e022b97cd3b369980f9eeafe7f5511d7675b6a448ed2fd4a63b88efa823f67d
DEBUG: process: view=complex_filter, delta_len=1, hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd, last_hash=e457bb0ed7c25faaccd170ed0020015f36235d20296b3ef28dff4fb86b7906fa
DEBUG: process: view=multi_order, delta_len=2, hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a, last_hash=fed02d9ede734134a57d9413fac0186501af0dcaf834a7b6b9b878b512ae6a4f
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.933218Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":2,\"items:3\":2,\"items:1\":2},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:11\":1,\"post:12\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2,\"items:3\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6134[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":2,\"items:3\":2,\"items:1\":2},\"rows\":{\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:10\":1,\"users_limit:20\":1},\"rows\":{\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"},\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:05\":1,\"post:11\":1,\"post:12\":1,\"post:13\":1,\"post:10\":1},\"rows\":{\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11},\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"},\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:2\":4,\"user:1\":3},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2,\"items:3\":2},\"last_hash\":\"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6134[0m
[2m2025-12-30T20:26:56.933315Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"items":{"name":"items","zset":{"items:2":2,"items:3":2,"items:1":2},"rows":{"items:1":{"active":true,"category":"A","hash":"0000","score":10},"items:2":{"active":false,"category":"A","hash":"0000","score":20},"items:3":{"active":true,"category":"B","hash":"0000","score":10}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"users_limit":{"name":"users_limit","zset":{"users_limit:10":1,"users_limit:20":1},"rows":{"users_limit:20":{"hash":"0000","id":20,"name":"A"},"users_limit:10":{"hash":"0001","id":10,"name":"B"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}},"post":{"name":"post","zset":{"post:05":1,"post:11":1,"post:12":1,"post:13":1,"post:10":1},"rows":{"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13},"post:11":{"author":1,"hash":"0000","id":11},"post:12":{"author":2,"hash":"0000","id":12}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:2":{"hash":"0001","id":2,"status":"active"},"user:1":{"hash":"0000","id":1,"status":"active"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:2":4,"user:1":3},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:10":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":2,"items:1":2},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{},"last_hash":"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:1":2,"items:3":2},"last_hash":"be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:2":2,"items:1":2},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}}]}'
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.934682Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mprocess[0m:[1mexecutor[0m:[1mexecutor[0m:[1mexecutor[0m: [2msurrealdb_core::ctx::context[0m[2m:[0m Capabilities allowed function execution, target: 'mod::dbsp::ingest' [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
DEBUG: normalize_record received direct record: Object {"active": Bool(true), "category": String("A"), "hash": String("0000"), "score": Number(30)}
DEBUG: load_state: Loading from DB...
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.935229Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mlength[0m[2m=[0m45[0m [2m[3minput[0m[2m=[0m"SELECT content FROM _spooky_module_state:dbsp" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m45[0m
[2m2025-12-30T20:26:56.935273Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mSELECT content FROM _spooky_module_state:dbsp
üü¢ Async body completed for: __sr_sql
DEBUG: process: view=complex_filter, delta_len=1, hash=8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc, last_hash=be5dcce8af6592be2f16c016da6bf2bab119b60b66dcf0d23b4acda2f0b4f6cd
DEBUG: process: view=multi_order, delta_len=2, hash=7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91, last_hash=652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a
üîµ Host function called: __sr_sql
üü° Executing async body for: __sr_sql
[2m2025-12-30T20:26:56.936738Z[0m [35mTRACE[0m [1mexpr[0m:[1mexpr_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL value [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":2,\"items:3\":2,\"items:1\":2,\"items:4\":1},\"rows\":{\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10},\"items:4\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":30}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:05\":1,\"post:13\":1,\"post:10\":1,\"post:12\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2,\"items:3\":2,\"items:4\":1},\"last_hash\":\"8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:4\":1},\"last_hash\":\"7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91\",\"params\":{}}]}'; RETURN []; }" [3mlength[0m[2m=[0m6224[0m [2m[3minput[0m[2m=[0m"{ LET $ign = UPSERT _spooky_module_state:dbsp SET content = '{\"db\":{\"tables\":{\"items\":{\"name\":\"items\",\"zset\":{\"items:2\":2,\"items:3\":2,\"items:1\":2,\"items:4\":1},\"rows\":{\"items:2\":{\"active\":false,\"category\":\"A\",\"hash\":\"0000\",\"score\":20},\"items:1\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":10},\"items:3\":{\"active\":true,\"category\":\"B\",\"hash\":\"0000\",\"score\":10},\"items:4\":{\"active\":true,\"category\":\"A\",\"hash\":\"0000\",\"score\":30}}},\"users_limit\":{\"name\":\"users_limit\",\"zset\":{\"users_limit:20\":1,\"users_limit:10\":1},\"rows\":{\"users_limit:10\":{\"hash\":\"0001\",\"id\":10,\"name\":\"B\"},\"users_limit:20\":{\"hash\":\"0000\",\"id\":20,\"name\":\"A\"}}},\"users\":{\"name\":\"users\",\"zset\":{\"users:active:99\":1,\"users:1\":1},\"rows\":{\"users:active:99\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Bob\"},\"users:1\":{\"hash\":\"0000\",\"id\":1,\"name\":\"Alice\"}}},\"post\":{\"name\":\"post\",\"zset\":{\"post:11\":1,\"post:05\":1,\"post:13\":1,\"post:10\":1,\"post:12\":1},\"rows\":{\"post:12\":{\"author\":2,\"hash\":\"0000\",\"id\":12},\"post:05\":{\"author\":1,\"hash\":\"0000\",\"id\":5},\"post:10\":{\"author\":1,\"hash\":\"0000\",\"id\":10},\"post:13\":{\"author\":2,\"hash\":\"0000\",\"id\":13},\"post:11\":{\"author\":1,\"hash\":\"0000\",\"id\":11}}},\"user\":{\"name\":\"user\",\"zset\":{\"user:2\":2,\"user:1\":1},\"rows\":{\"user:1\":{\"hash\":\"0000\",\"id\":1,\"status\":\"active\"},\"user:2\":{\"hash\":\"0001\",\"id\":2,\"status\":\"active\"}}},\"tree_items\":{\"name\":\"tree_items\",\"zset\":{\"item:2\":1},\"rows\":{\"item:2\":{\"hash\":\"0001\",\"id\":\"item:2\",\"val\":\"B\"}}},\"posts\":{\"name\":\"posts\",\"zset\":{\"posts:10\":1},\"rows\":{\"posts:10\":{\"author\":1,\"hash\":\"0001\",\"id\":10,\"title\":\"Hello\"}}},\"threads\":{\"name\":\"threads\",\"zset\":{\"threads:2024:1\":1},\"rows\":{\"threads:2024:1\":{\"hash\":\"0000\",\"title\":\"Hello\"}}},\"users_incr\":{\"name\":\"users_incr\",\"zset\":{\"users_incr:active:1\":1},\"rows\":{\"users_incr:active:1\":{\"active\":true,\"hash\":\"0000\",\"name\":\"Alice\"}}}}},\"views\":[{\"plan\":{\"id\":\"view_users_incr\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users_incr\"},\"predicate\":{\"type\":\"eq\",\"field\":\"id\",\"value\":\"users_incr:active:1\"}}},\"cache\":{\"users_incr:active:1\":1},\"last_hash\":\"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f\",\"params\":{}},{\"plan\":{\"id\":\"view_users_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"users\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{\"users:active:99\":1},\"last_hash\":\"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915\",\"params\":{}},{\"plan\":{\"id\":\"view_threads_recent\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"threads\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"threads:2024\"}}},\"cache\":{\"threads:2024:1\":1},\"last_hash\":\"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8\",\"params\":{}},{\"plan\":{\"id\":\"view_users_threads_join\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"threads\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"users:active\"}}},\"cache\":{},\"last_hash\":\"\",\"params\":{}},{\"plan\":{\"id\":\"view_tree_test\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"tree_items\"},\"predicate\":{\"type\":\"prefix\",\"prefix\":\"item\"}}},\"cache\":{\"item:2\":1},\"last_hash\":\"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6\",\"params\":{}},{\"plan\":{\"id\":\"view_join_sql\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"users\"},\"right\":{\"op\":\"scan\",\"table\":\"posts\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"users:1\":1},\"last_hash\":\"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858\",\"params\":{}},{\"plan\":{\"id\":\"view_limit_eviction\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"users_limit\"},\"limit\":1,\"order_by\":null}},\"cache\":{\"users_limit:10\":1},\"last_hash\":\"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775\",\"params\":{}},{\"plan\":{\"id\":\"view_nested_limit\",\"root\":{\"op\":\"project\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"projections\":[{\"type\":\"all\"},{\"type\":\"subquery\",\"alias\":\"subquery\",\"plan\":{\"op\":\"limit\",\"input\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"predicate\":{\"type\":\"eq\",\"field\":\"author\",\"value\":{\"$param\":\"id\"}}},\"limit\":2,\"order_by\":null}}]}},\"cache\":{\"user:2\":2,\"user:1\":1},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_active\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"user\"},\"predicate\":{\"type\":\"eq\",\"field\":\"status\",\"value\":\"active\"}}},\"cache\":{\"user:1\":1,\"user:2\":2},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_u_p\",\"root\":{\"op\":\"join\",\"left\":{\"op\":\"scan\",\"table\":\"user\"},\"right\":{\"op\":\"scan\",\"table\":\"post\"},\"on\":{\"left_field\":\"id\",\"right_field\":\"author\"}}},\"cache\":{\"user:1\":3,\"user:2\":4},\"last_hash\":\"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78\",\"params\":{}},{\"plan\":{\"id\":\"view_feed\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"post\"},\"limit\":3,\"order_by\":null}},\"cache\":{\"post:05\":1,\"post:10\":1,\"post:11\":1},\"last_hash\":\"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033\",\"params\":{}},{\"plan\":{\"id\":\"view_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"val\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:1\":2},\"last_hash\":\"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a\",\"params\":{}},{\"plan\":{\"id\":\"view_or\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"or\",\"predicates\":[{\"type\":\"eq\",\"field\":\"val\",\"value\":10},{\"type\":\"eq\",\"field\":\"val\",\"value\":100}]}}},\"cache\":{},\"last_hash\":\"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262\",\"params\":{}},{\"plan\":{\"id\":\"complex_filter\",\"root\":{\"op\":\"filter\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"predicate\":{\"type\":\"eq\",\"field\":\"active\",\"value\":true}}},\"cache\":{\"items:1\":2,\"items:3\":2,\"items:4\":1},\"last_hash\":\"8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc\",\"params\":{}},{\"plan\":{\"id\":\"multi_order\",\"root\":{\"op\":\"limit\",\"input\":{\"op\":\"scan\",\"table\":\"items\"},\"limit\":2,\"order_by\":[{\"field\":\"category\",\"direction\":\"ASC\"},{\"field\":\"score\",\"direction\":\"DESC\"}]}},\"cache\":{\"items:2\":2,\"items:4\":1},\"last_hash\":\"7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91\",\"params\":{}}]}'; RETURN []; }" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: None, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m6224[0m
üü¢ Async body completed for: __sr_sql
[2m2025-12-30T20:26:56.936828Z[0m [35mTRACE[0m [2msurrealdb::core::dbs[0m[2m:[0m Iterating statement [3mstatement[0m[2m=[0mUPSERT _spooky_module_state:dbsp SET content = '{"db":{"tables":{"items":{"name":"items","zset":{"items:2":2,"items:3":2,"items:1":2,"items:4":1},"rows":{"items:2":{"active":false,"category":"A","hash":"0000","score":20},"items:1":{"active":true,"category":"A","hash":"0000","score":10},"items:3":{"active":true,"category":"B","hash":"0000","score":10},"items:4":{"active":true,"category":"A","hash":"0000","score":30}}},"users_limit":{"name":"users_limit","zset":{"users_limit:20":1,"users_limit:10":1},"rows":{"users_limit:10":{"hash":"0001","id":10,"name":"B"},"users_limit:20":{"hash":"0000","id":20,"name":"A"}}},"users":{"name":"users","zset":{"users:active:99":1,"users:1":1},"rows":{"users:active:99":{"active":true,"hash":"0000","name":"Bob"},"users:1":{"hash":"0000","id":1,"name":"Alice"}}},"post":{"name":"post","zset":{"post:11":1,"post:05":1,"post:13":1,"post:10":1,"post:12":1},"rows":{"post:12":{"author":2,"hash":"0000","id":12},"post:05":{"author":1,"hash":"0000","id":5},"post:10":{"author":1,"hash":"0000","id":10},"post:13":{"author":2,"hash":"0000","id":13},"post:11":{"author":1,"hash":"0000","id":11}}},"user":{"name":"user","zset":{"user:2":2,"user:1":1},"rows":{"user:1":{"hash":"0000","id":1,"status":"active"},"user:2":{"hash":"0001","id":2,"status":"active"}}},"tree_items":{"name":"tree_items","zset":{"item:2":1},"rows":{"item:2":{"hash":"0001","id":"item:2","val":"B"}}},"posts":{"name":"posts","zset":{"posts:10":1},"rows":{"posts:10":{"author":1,"hash":"0001","id":10,"title":"Hello"}}},"threads":{"name":"threads","zset":{"threads:2024:1":1},"rows":{"threads:2024:1":{"hash":"0000","title":"Hello"}}},"users_incr":{"name":"users_incr","zset":{"users_incr:active:1":1},"rows":{"users_incr:active:1":{"active":true,"hash":"0000","name":"Alice"}}}}},"views":[{"plan":{"id":"view_users_incr","root":{"op":"filter","input":{"op":"scan","table":"users_incr"},"predicate":{"type":"eq","field":"id","value":"users_incr:active:1"}}},"cache":{"users_incr:active:1":1},"last_hash":"2b6c863c084ac0d24d95e7fffd27ec6352596944ab74529e997faf665286798f","params":{}},{"plan":{"id":"view_users_active","root":{"op":"filter","input":{"op":"scan","table":"users"},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{"users:active:99":1},"last_hash":"38bb61d3f5529b9c5bd4291d4320f067279f8e542d44ea0bf781e01af5dff915","params":{}},{"plan":{"id":"view_threads_recent","root":{"op":"filter","input":{"op":"scan","table":"threads"},"predicate":{"type":"prefix","prefix":"threads:2024"}}},"cache":{"threads:2024:1":1},"last_hash":"3f148fd17e41edd62e84b323725230beabcdbb89acf0dbf4d1c223dc4fc414e8","params":{}},{"plan":{"id":"view_users_threads_join","root":{"op":"filter","input":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"threads"},"on":{"left_field":"id","right_field":"author"}},"predicate":{"type":"prefix","prefix":"users:active"}}},"cache":{},"last_hash":"","params":{}},{"plan":{"id":"view_tree_test","root":{"op":"filter","input":{"op":"scan","table":"tree_items"},"predicate":{"type":"prefix","prefix":"item"}}},"cache":{"item:2":1},"last_hash":"7ddad85f208ef96ffa15306947f68dccfb9f74d51991cd3d7de5ae528f4b2cd6","params":{}},{"plan":{"id":"view_join_sql","root":{"op":"join","left":{"op":"scan","table":"users"},"right":{"op":"scan","table":"posts"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"users:1":1},"last_hash":"eddfdf753d62b56eb28867717b9bc765ca465f2e096a4e5bdba992610aae9858","params":{}},{"plan":{"id":"view_limit_eviction","root":{"op":"limit","input":{"op":"scan","table":"users_limit"},"limit":1,"order_by":null}},"cache":{"users_limit:10":1},"last_hash":"3ed259e81f4bf5e7ce2fe071f15f4b188c849ec9318a46d0dc2a0eeb4b582775","params":{}},{"plan":{"id":"view_nested_limit","root":{"op":"project","input":{"op":"scan","table":"user"},"projections":[{"type":"all"},{"type":"subquery","alias":"subquery","plan":{"op":"limit","input":{"op":"filter","input":{"op":"scan","table":"post"},"predicate":{"type":"eq","field":"author","value":{"$param":"id"}}},"limit":2,"order_by":null}}]}},"cache":{"user:2":2,"user:1":1},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_active","root":{"op":"filter","input":{"op":"scan","table":"user"},"predicate":{"type":"eq","field":"status","value":"active"}}},"cache":{"user:1":1,"user:2":2},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_u_p","root":{"op":"join","left":{"op":"scan","table":"user"},"right":{"op":"scan","table":"post"},"on":{"left_field":"id","right_field":"author"}}},"cache":{"user:1":3,"user:2":4},"last_hash":"02110b0857d9a73f9d5ac453463a7bc5d80cbc4ceda862a83b27039c16091a78","params":{}},{"plan":{"id":"view_feed","root":{"op":"limit","input":{"op":"scan","table":"post"},"limit":3,"order_by":null}},"cache":{"post:05":1,"post:10":1,"post:11":1},"last_hash":"7859d3f969dbd0d4d18e60d2f94b8fbb8c027f5d3a12e854331e6da0b852d033","params":{}},{"plan":{"id":"view_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"val","direction":"DESC"}]}},"cache":{"items:2":2,"items:1":2},"last_hash":"652baaf43a432f6aca3d035ecb26d140fc027b2bc6bd412f9bca52a345ccda1a","params":{}},{"plan":{"id":"view_or","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"or","predicates":[{"type":"eq","field":"val","value":10},{"type":"eq","field":"val","value":100}]}}},"cache":{},"last_hash":"af1349b9f5f9a1a6a0404dea36dcc9499bcb25c9adc112b7cc9a93cae41f3262","params":{}},{"plan":{"id":"complex_filter","root":{"op":"filter","input":{"op":"scan","table":"items"},"predicate":{"type":"eq","field":"active","value":true}}},"cache":{"items:1":2,"items:3":2,"items:4":1},"last_hash":"8ea66da9a6dbcfebdbc0d304e1efb5417f354b0d999d0cd585edb810bef154bc","params":{}},{"plan":{"id":"multi_order","root":{"op":"limit","input":{"op":"scan","table":"items"},"limit":2,"order_by":[{"field":"category","direction":"ASC"},{"field":"score","direction":"DESC"}]}},"cache":{"items:2":2,"items:4":1},"last_hash":"7cce54002ea011de82dcefadb6b955259ecf09447846010c5af9fda3c58e4b91","params":{}}]}'
[2m2025-12-30T20:26:56.937729Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Finished processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"1042" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"7fba4d12-9134-437c-9ffe-0d97cd1b2b8a" [3mclient.address[0m[2m=[0m"192.168.65.1" [3mhttp.response.status_code[0m[2m=[0m200 [3mhttp.latency.ms[0m[2m=[0m17[0m
[2m2025-12-30T20:26:56.940663Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_server::ntw::tracer[0m[2m:[0m Started processing request [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"687fce0e-4b51-43df-830b-fd670475e3f4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.940681Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Attempting token authentication [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"687fce0e-4b51-43df-830b-fd670475e3f4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.940697Z[0m [35mTRACE[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticating to root level with user `root` [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"687fce0e-4b51-43df-830b-fd670475e3f4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.940734Z[0m [34mDEBUG[0m [1mrequest[0m: [2msurrealdb_core::iam::verify[0m[2m:[0m Authenticated to root level with user `root` using token [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"687fce0e-4b51-43df-830b-fd670475e3f4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m
[2m2025-12-30T20:26:56.940815Z[0m [35mTRACE[0m [1mrequest[0m:[1mexecute[0m:[1mparse_with_capabilities[0m: [2msurrealdb::core::syn[0m[2m:[0m Parsing SurrealQL query [2m[3motel.kind[0m[2m=[0m"server" [3mhttp.request.method[0m[2m=[0m"POST" [3murl.path[0m[2m=[0m"/rpc" [3mnetwork.protocol.name[0m[2m=[0m"http" [3mnetwork.protocol.version[0m[2m=[0m"1.1" [3mhttp.request.body.size[0m[2m=[0m"71" [3muser_agent.original[0m[2m=[0m"node" [3motel.name[0m[2m=[0m"POST /rpc" [3mhttp.route[0m[2m=[0m"/rpc" [3mhttp.request.id[0m[2m=[0m"687fce0e-4b51-43df-830b-fd670475e3f4" [3mclient.address[0m[2m=[0m"192.168.65.1"[0m [2m[3minput[0m[2m=[0m"REMOVE DATABASE test_db;" [3mcapabilities[0m[2m=[0mCapabilities { scripting: true, guest_access: true, live_query_notifications: true, allow_funcs: All, deny_funcs: None, allow_net: All, deny_net: None, allow_rpc: All, deny_rpc: None, allow_http: All, deny_http: None, allow_experimental: All, deny_experimental: None, allow_arbitrary_query: All, deny_arbitrary_query: None } [3mlength[0m[2m=[0m24[0m
FAIL surrealdb/dbsp.test.ts
  DBSP Module Integration
    ‚úì should register a view and ingest data with incremental updates (7 ms)
    ‚úì should support multiple concurrent views (8 ms)
    ‚úì should register a complex join plan (SQL) (6 ms)
    ‚úì should update id tree on data change (9 ms)
    ‚úì should support complex recursive join with subquery via SQL (7 ms)
    ‚úì should handle limit eviction (7 ms)
    ‚úï should handle nested limit via subquery projection (SQL) (4 ms)
    ‚úì Full Scenario: Social Network End-to-End (24 ms)
    ‚úì should handle ORDER BY and OR logic (14 ms)
    ‚úì should handle complex AND/OR and multi-field ORDER BY (21 ms)

  ‚óè DBSP Module Integration ‚Ä∫ should handle nested limit via subquery projection (SQL)

    expect(received).toContain(expected) // indexOf

    Expected substring: "Registered view"
    Received string:    "Registered"

      220 |     const res = await runQuery(chainedQuery);
      221 |     const r1 = res[res.length - 1];
    > 222 |     expect(r1.msg).toContain('Registered view');
          |                    ^
      223 |   });
      224 |
      225 |   test('Full Scenario: Social Network End-to-End', async () => {

      at Object.<anonymous> (surrealdb/dbsp.test.ts:222:20)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 9 passed, 10 total
Snapshots:   0 total
Time:        4.745 s, estimated 5 s
Ran all test suites matching /surrealdb\/dbsp.test.ts/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
/Users/khadim/dev/spooky/tests:
‚ÄâERR_PNPM_RECURSIVE_RUN_FIRST_FAIL‚Äâ @spooky/tests@0.0.0 test: `jest --runInBand surrealdb/dbsp.test.ts`
Exit status 1
